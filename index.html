<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alfanan-Supplements</title>
    <link rel="icon" href="icon1.png" type="image/svg+xml">
    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <!-- Firebase Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <!-- Firebase Analytics (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Teko:wght@500;700&display=swap');
        body {
            margin: 0;
            font-family: 'Teko', Arial, sans-serif;
            background: #faf9f6;
            color: #222;
            min-height: 100vh;
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff;
            padding: 0px;
            height: 54px;
            box-shadow: 0 2px 8px #e0e0e0;
        }
        #headerBar {
            background: #fff !important;
            box-shadow: 0 2px 8px #e0e0e0 !important;
        }
        .navbar .logo {
            font-size: 2.2rem;
            font-weight: 700;
            letter-spacing: 2px;
            color: #bfa14a;
            display: flex;
            align-items: center;
            padding: 10px;
        }
        .navbar ul {
            display: flex;
            gap: 1px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .navbar li {
            cursor: pointer;
            font-size: 2.1rem;
            font-weight: bold;
            transition: color 0.2s;
            position: relative;
            padding: 0 5px 2px 5px;
        }
        .navbar li:hover, .navbar li.active {
            color: #bfa14a;
        }
        .navbar li::after {
            content: '';
            display: block;
            margin: 0 auto;
            margin-top: 4px;
            width: 28px;
            height: 4px;
            border-radius: 2px;
            background: transparent;
            transition: background 0.2s, width 0.2s;
        }
        .navbar li.active::after,
        .navbar li:hover::after {
            background: #bfa14a33;
            width: 32px;
        }
        #searchBarContainer {
            margin-bottom: 0 !important;
        }
        #searchInput::placeholder {
            color: #bbb;
            opacity: 1;
        }
        #searchInput {
            background: #fff;
            color: #bfa14a;
            border: 1.5px solid #bfa14a;
            box-shadow: 0 2px 8px #bfa14a33;
            transition: box-shadow 0.2s, border 0.2s;
            margin-left: 10px;
        }
        #searchInput:focus {
            outline: none;
            border: 1.5px solid #bfa14a;
            box-shadow: 0 0 0 2px #bfa14a33;
        }
        .container {
            max-width: 1100px;
            margin: 16px auto 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 24px #e0e0e0;
            border: 1px solid #bfa14a33;
        }
        .admin-login-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .admin-login-box {
            background: #fff;
            padding: 32px 28px;
            border-radius: 10px;
            box-shadow: 0 2px 16px #e0e0e0;
            min-width: 320px;
            text-align: center;
        }
        .admin-login-box h2 {
            margin-bottom: 18px;
            color: #bfa14a;
            font-size: 2rem;
        }
        .admin-login-box input {
            width: 90%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1.1rem;
        }
        .admin-login-box button {
            background: #c9b037;
            color: #222;
            border: none;
            padding: 10px 30px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        .admin-login-box .error {
            color: #ff4444;
            font-size: 1rem;
            margin-top: 8px;
        }
        .admin-panel {
            text-align: right;
        }
        .admin-panel h2 {
            color: #bfa14a;
            margin-bottom: 18px;
        }
        .add-product-btn {
            background: #bfa14a !important;
            color: #fff !important;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 18px;
        }
        .product-form {
            background: #ecf1eb;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 18px 20px;
            margin-bottom: 24px;
            direction: rtl;
        }
        .product-form label {
            display: block;
            margin: 10px 0 4px 0;
            font-size: 1.1rem;
        }
        .product-form input, .product-form textarea, .product-form select {
            width: 100%;
            padding: 8px;
            border-radius: 6px;
            border: none;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .product-form input[type="file"] {
            background: #fff;
            color: #222;
        }
        .product-form button {
            background: #c9b037;
            color: #222;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
        }
        .products-list {
            margin-top: 30px;
        }
        .product-card {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 12px #e0e0e0;
            border: 1px solid #eec9d2;
            padding: 10px 20px;
            margin-bottom: 12px;
            display: flex;
            gap: 12px;
            align-items: flex-start;
            position: relative;
        }
        .product-card img {
            width: 180px;
            height: 180px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #eec9d2;
            background: #fff;
        }
        .product-info {
            flex: 1;
        }
        .product-title {
            font-size: 1.5rem;
            color: #5a4e7c;
            margin-bottom: 6px;
        }
        .product-desc {
            font-size: 1.1rem;
            margin-bottom: 2px;
        }
        .product-type {
            font-size: 1rem;
            color: #aaa;
            margin-bottom: 0;
        }
        .product-prices {
            font-size: 1.5rem;
            margin-bottom: 6px;
            font-weight: bold;
            display: flex;
            flex-direction: row-reverse;
            justify-content: flex-start;
            align-items: center;
            gap: 12px;
        }
        .product-prices del {
            color: #b45d8c;
            margin-right: 8px;
            margin-left: 0;
        }
        .product-actions {
            display: flex;
            flex-direction: row;
            gap: 16px;
            justify-content: center;
            align-items: center;
            margin-top: 18px;
            position: static;
        }
        .product-actions button {
            background: none;
            color: #c9b037;
            border: none;
            border-radius: 5px;
            padding: 4px 6px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
            display: flex;
            align-items: center;
        }
        .product-actions button:hover {
            color: #fff;
            background: #c9b037;
        }
        .section-title {
            font-size: 2rem;
            color: #5a4e7c;
            margin-bottom: 18px;
            text-align: center;
        }
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 24px;
        }
        .products-grid .product-card {
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            opacity: 0;
            transform: translateY(30px);
            animation: productFadeIn 0.35s cubic-bezier(.36,.07,.19,.97) forwards;
            animation-delay: var(--fade-delay, 0ms);
        }
        @keyframes productFadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .products-grid .product-card img, .products-grid .img-slider {
            width: 180px !important;
            height: 180px !important;
            max-width: 100%;
            max-height: 100%;
        }
        @media (max-width: 700px) {
            .container { padding: 8px; }
            .navbar { flex-direction: column; height: auto; padding: 0 4px; }
            .navbar { font-size: 1.5rem; }
            .logo { font-size: 2.3rem !important; color: #5a4e7c !important; }
            .navbar ul { gap: 6px; }
            .navbar li { font-size: 1.5rem !important; padding: 0 3px 2px 3px; }
            #searchInput { font-size: 1.3rem !important; }
        }
        /* Splash Screen Animations */
        @keyframes shake {
            0% { transform: translate(0, 0) rotate(0deg); }
            10% { transform: translate(-20px, 0) rotate(-10deg); }
            20% { transform: translate(20px, 0) rotate(10deg); }
            30% { transform: translate(-20px, 0) rotate(-10deg); }
            40% { transform: translate(20px, 0) rotate(10deg); }
            50% { transform: translate(-20px, 0) rotate(-10deg); }
            60% { transform: translate(20px, 0) rotate(10deg); }
            70% { transform: translate(-20px, 0) rotate(-10deg); }
            80% { transform: translate(-20px, 0) rotate(-10deg); }
            90% { transform: translate(20px, 0) rotate(10deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
        @keyframes dropDown {
            0% { transform: translateY(0); }
            80% { transform: translateY(0); }
            100% { transform: translateY(100vh); }
        }
        @keyframes shakeCart {
            0% { transform: translate(0, 0) rotate(0deg); }
            20% { transform: translate(-4px, 0) rotate(-8deg); }
            40% { transform: translate(4px, 0) rotate(8deg); }
            60% { transform: translate(-4px, 0) rotate(-8deg); }
            80% { transform: translate(4px, 0) rotate(8deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
        .shake-cart {
            animation: shakeCart 0.6s cubic-bezier(.36,.07,.19,.97) both;
        }
        .add-to-cart-msg {
            position: fixed;
            top: 80px;
            right: 30px;
            background: #f346f3;
            color: #fff;
            font-size: 1.1rem;
            font-weight: bold;
            padding: 14px 28px;
            border-radius: 10px;
            box-shadow: 0 2px 12px #e0e0e0;
            z-index: 99999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
        }
        .add-to-cart-msg.show {
            opacity: 1;
            transform: translateY(0);
        }
        #cartBtn svg circle {
            fill: #c9b037 !important;
        }
        #cartBtn svg path {
            fill: #bfa14a !important;
        }
        #favoritesBtn svg path {
            fill: #c9b037 !important;
        }
        /* Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙŠ Ø§Ù„Ù†Ø§Ø¨ Ø¨Ø§Ø± ØªÙ…Ø§Ù…Ù‹Ø§ */
        li#adminBtn[data-section="admin"] {
            width: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            overflow: hidden !important;
            display: inline-block !important;
        }
        /* Ø¥Ø®ÙØ§Ø¡ Ù†Øµ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬ (man, woman, offers) ÙÙŠ ÙƒØ§Ø±Øª Ø§Ù„Ù…Ù†ØªØ¬ */
        .product-card .product-type {
            font-size: 0 !important;
            height: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            line-height: 0 !important;
        }
        .add-to-cart-btn {
            margin-top: 2px !important;
            background: #c9b037 !important;
            color: #222 !important;
            border: none;
        }
        .add-to-cart-btn:hover {
            background: #bfa14a !important;
            color: #fff !important;
        }
        .add-product-btn, .order-status-select {
            background: #e6b400 !important;
            color: #fff !important;
            border: none;
        }
        .add-product-btn:hover, .order-status-select:hover {
            background: #fffbe6 !important;
            color: #b38f00 !important;
        }
        /* Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù‚Ù„Ø¨ Ø¨Ù†ÙØ³Ø¬ÙŠ Ø¯Ø§ÙƒÙ† */
        #favoritesBtn svg path {
            stroke: rgb(100, 68, 109) !important;
        }
        /* Ø±Ù‚Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª ÙÙˆÙ‚ Ø§Ù„Ù‚Ù„Ø¨ Ø£Ø¨ÙŠØ¶ Ø¨Ø®Ù„ÙÙŠØ© Ø¨Ù†ÙØ³Ø¬ÙŠ ÙØ§ØªØ­ */
        #favoritesCount {
            background: #ff4444 !important;
            color: #fff !important;
        }
         @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        /* Ø£Ù„ÙˆØ§Ù† Ø²Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© */
        .order-status-select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            padding: 6px 28px 6px 8px !important;
            border-radius: 8px !important;
            font-weight: bold !important;
            border: 2px solid #ffb300 !important;
            background: #ffb300 !important;
            color: #222 !important;
            transition: background 0.2s, color 0.2s, border 0.2s;
            cursor: pointer;
            min-width: 120px;
            text-align: center;
        }
        .order-status-select.delivered {
            background: #25d366 !important;
            color: #fff !important;
            border-color: #25d366 !important;
        }
        .order-status-select.cancelled {
            background: #ff4444 !important;
            color: #fff !important;
            border-color: #ff4444 !important;
        }
        .order-status-select.pending {
            background: #ffb300 !important;
            color: #222 !important;
            border-color: #ffb300 !important;
        }
        /* --- ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ ÙÙˆØ±Ù… Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¹ Floating Label --- */
        .order-form-modern {
            max-width: 400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 22px;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 24px #e0e0e0;
            padding: 32px 24px 24px 24px;
            position: relative;
        }
        .order-form-modern .form-group {
            direction: rtl;
            width: 103%;
            position: relative;
            margin-bottom: 0;
        }
        .order-form-modern input,
        .order-form-modern textarea {
            width: 95%;
            padding: 18px 12px 10px 12px;
            border: 1.5px solid #eec9d2;
            border-radius: 8px;
            font-size: 1.15rem;
            background: #faf9f6;
            color: #5a4e7c;
            outline: none;
            transition: border 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 8px #eec9d2;
        }
        .order-form-modern input:focus,
        .order-form-modern textarea:focus {
            border: 1.5px solid #b9b4e7;
            box-shadow: 0 0 0 2px #b9b4e733;
        }
        .order-form-modern label {
            position: absolute;

            top: 9px;
            right: 15px;
            background: transparent;
            color: #b9b4e7;
            font-size: 1.1rem;
            pointer-events: none;
            transition: 0.2s cubic-bezier(.36,.07,.19,.97);
            padding: 0 4px;
            z-index: 2;
        }
        .order-form-modern input:not(:placeholder-shown) + label,
        .order-form-modern input:focus + label,
        .order-form-modern textarea:not(:placeholder-shown) + label,
        .order-form-modern textarea:focus + label {
            top: -10px;
            right: 2px;
            font-size: 0.95rem;
            color: #a1589e;
            background: #fff;
            padding: 0 6px;
            border-radius: 6px;
        }
        .order-form-modern textarea {
            min-height: 60px;
            resize: vertical;
        }
        .order-form-modern button[type="submit"] {
            background: linear-gradient(90deg, #bfa14a 0%, #c9b037 100%);
            color: #222;
            font-weight: bold;
            padding: 14px 0;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            border: none;
            margin-top: 10px;
            box-shadow: 0 2px 8px #eec9d2;
            transition: background 0.2s, color 0.2s;
        }
        .order-form-modern button[type="submit"]:hover {
            background: linear-gradient(90deg, #c9b037 0%, #bfa14a 100%);
            color: #fff;
        }
        .order-form-modern .error-msg {
            color: #ff4444;
            font-size: 1rem;
            margin-top: 2px;
            margin-bottom: -10px;
            min-height: 18px;
        }
        .order-form-modern .success-msg {
            color: #25d366;
            font-size: 1rem;
            margin-top: 2px;
            margin-bottom: -10px;
            min-height: 18px;
        }
        .order-form-modern #orderTotalBox {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            margin: 8px 0 0 0;
        }
        /* Ø²Ø± Ø¹ØµØ±ÙŠ Ù…ÙˆØ­Ø¯ Ù„Ù„ÙÙˆØ±Ù… ÙˆØ§Ù„Ø³Ù„Ø© */
        .btn-modern {
            background: linear-gradient(90deg, #a1589e 0%, #eec9d2 100%);
            color: #fff;
            font-weight: bold;
            padding: 14px 0;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            border: none;
            margin-top: 10px;
            box-shadow: 0 2px 8px #eec9d2;
            transition: background 0.2s, color 0.2s;
            width: 100%;
            max-width: 320px;
        }
        .btn-modern:hover {
            background: linear-gradient(90deg, #eec9d2 0%, #a1589e 100%);
            color: #fff;
        }
    </style>
    <style>
        /* Ù„Ù…Ø¹Ø© Ù…ØªØ­Ø±ÙƒØ© Ø¹Ù„Ù‰ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ø§Ù Ø¨Ø§Ø± Ø¹Ù†Ø¯ Ø§Ù„ÙˆÙ‚ÙˆÙ */
        .navbar li {
            position: relative;
            overflow: hidden;
        }
        .navbar li .shine {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            background: linear-gradient(120deg, transparent 0%, #fff8 40%, #fff 50%, #fff8 60%, transparent 100%);
            transform: translateX(-100%);
            animation: shine-move 1.2s linear infinite;
            z-index: 2;
            display: none;
        }
        .navbar li.active .shine {
            animation-play-state: running;
            display: block;
        }
        @keyframes shine-move {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
    </style>
</head>
<body>
    <!-- Loader Icon (under navbar) -->
    <div id="mainLoader" style="position:absolute;z-index:9000;top:110px;left:0;width:100vw;height:calc(100vh - 110px);background:rgba(255,255,255,0.95);display:none;align-items:center;justify-content:center;transition:opacity 0.4s;">
        <div style="display:flex;flex-direction:column;align-items:center;">
            <div style="position:relative;width:60px;height:60px;display:flex;align-items:center;justify-content:center;">
                <div class="loader-spinner" style="border:4px solid #e0e0e0;border-top:4px solid #784fe7;border-radius:50%;width:44px;height:44px;animation:spin 1s linear infinite;position:absolute;left:8px;top:8px;"></div>
                <img src="icon1.png" alt="Ø¹Ø·Ø±" style="width:38px;height:38px;object-fit:contain;z-index:2;position:relative;filter:drop-shadow(0 2px 8px #b9b4e7cc);" />
            </div>
            <div style="margin-top:14px;font-size:1.1rem;color:#784fe7;font-weight:bold;">Loading...</div>
        </div>
    </div>
    <style>
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    </style>
    <!-- Ù†Ù‡Ø§ÙŠØ© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <!-- Splash Screen -->
    <div id="splashScreen" style="position:fixed;z-index:20000;top:0;left:0;width:100vw;height:100vh;background:#faf9f6;display:flex;align-items:center;justify-content:center;flex-direction:column;transition:opacity 0.4s;">
        <img id="splashLogo" src="icon1.png" alt="Logo" style="width:120px;height:120px;" />
    </div>
    <!-- Ù†Ù‡Ø§ÙŠØ© Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="headerBar" style="position:sticky;top:0;z-index:10000;background:#fff;box-shadow:0 2px 8px #e0e0e0;">
        <div style="display:flex;flex-direction:column;align-items:stretch;">
            <!-- Ø´Ø±ÙŠØ· Ù…Ø§Ø±ÙƒÙŠ Ù…ØªØ­Ø±Ùƒ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆØ¬Ùˆ -->
            <div id="promoBar" style="width:100%;background:#784fe7;color:#fff;font-size:1.5rem;font-weight:bold;letter-spacing:2px;position:relative;overflow:hidden;height:34px;display:flex;align-items:center;justify-content:center;">
                <div style="white-space:nowrap;display:inline-block;animation:marquee 20s linear infinite;">
                    Ø§Ø´ØªØ±ÙŠ  <b style="color: #8f0794;">Ø¨Ù€ 1000 Ø¬Ù†ÙŠØ© </b>  ÙˆØ§Ø­ØµÙ„ Ø¹Ù„ÙŠ  <b style="color: #8f0794;">Ù‡Ø¯ÙŠØ© </b> Ù…Ø¬Ø§Ù†ÙŠØ© !! &nbsp; â€¢ &nbsp; Ø§Ø´ØªØ±ÙŠ  <b style="color: #8f0794;">Ø¨Ù€ 1000 Ø¬Ù†ÙŠØ© </b>ÙˆØ§Ø­ØµÙ„ Ø¹Ù„ÙŠ  <b style="color: #8f0794;">Ù‡Ø¯ÙŠØ© </b> Ù…Ø¬Ø§Ù†ÙŠØ© !! &nbsp; â€¢ &nbsp; Ø§Ø´ØªØ±ÙŠ  <b style="color: #8f0794;">Ø¨Ù€ 1000 Ø¬Ù†ÙŠØ© </b>ÙˆØ§Ø­ØµÙ„ Ø¹Ù„ÙŠ  <b style="color: #8f0794;">Ù‡Ø¯ÙŠØ© </b> Ù…Ø¬Ø§Ù†ÙŠØ© !! &nbsp; â€¢ &nbsp; Ø§Ø´ØªØ±ÙŠ  <b style="color: #8f0794;">Ø¨Ù€ 1000 Ø¬Ù†ÙŠØ© </b>ÙˆØ§Ø­ØµÙ„ Ø¹Ù„ÙŠ  <b style="color: #8f0794;">Ù‡Ø¯ÙŠØ© </b> Ù…Ø¬Ø§Ù†ÙŠØ© !!
                </div>
            </div>
       
            <div style="width:100%;display:flex;justify-content:center;align-items:center;">
                <div class="logo" style="display:flex;justify-content:center;align-items:center;">
                    <img src="icon1.png" alt="Ø¹Ø·Ø±" style="height:54px;width:auto;display:block;" />
                </div>
            </div>
            <div style="width:100%;display:flex;justify-content:center;align-items:center;margin:8px 0 0 0;gap:12px;">
                <div id="searchBarContainer" style="display:flex;justify-content:center;align-items:center;gap:12px;margin:0;">
                    <input  id="searchInput" type="text" placeholder=" Search ...ğŸ”" 
                        style="width:60%;max-width:400px;padding:10px 16px;font-size:1.2rem;border-radius:8px;"/>
                    <button id="favoritesBtn" style="position:relative;background:none;border:none;cursor:pointer;outline:none;display:flex;align-items:center;margin-right:0px;">
                        <svg id="favoritesIcon" width="36" height="36" viewBox="0 0 24 24" fill="none">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                                stroke="#ffb300" stroke-width="2" fill="#232323"/>
                        </svg>
                        <span id="favoritesCount" style="position:absolute;top:0;right:0;background:#ffb300;color:#222;font-size:1rem;font-weight:bold;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;">0</span>
                    </button>
                    <button id="cartBtn" style="position:relative;background:none;border:none;cursor:pointer;outline:none;display:flex;align-items:center;margin-left:0px; margin-right: 10px;">
                        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect width="36" height="36" fill="#fff"/>
                            <path d="M6 7h12l-1.5 9.5a2 2 0 0 1-2 1.5h-3a2 2 0 0 1-2-1.5L6 7z" stroke="#5a4e7c" stroke-width="2" fill="none"/>
                            <path d="M9 7V5a3 3 0 0 1 6 0v2" stroke="#5a4e7c" stroke-width="2" fill="none"/>
                            <circle cx="10.5" cy="19" r="1.2" fill="#b9b4e7"/>
                            <circle cx="15.5" cy="19" r="1.2" fill="#b9b4e7"/>
                        </svg>
                        <span id="cartCount" style="position:absolute;top:0;right:0;background:#ff4444;color:#fff;font-size:1rem;font-weight:bold;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;">0</span>
                    </button>
                </div>
            </div>
            <nav class="navbar" style="background:none;box-shadow:none;padding-bottom:0;justify-content:center;">
                <ul style="margin:0 auto;">
                    <li data-section="admin" id="adminBtn" title="Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†"></li>
                    <li style="padding-top: 7px;" data-section="creatine" class="active">Creatine</li>
                    <li style="padding-top: 7px;" data-section="protein">Protein</li>
                    <li style="padding-top: 7px;" data-section="gainer">Gainer</li>
                    <li style="padding-top: 7px;" data-section="offers">Offers</li>
                    <li style="padding-top: 7px;" data-section="others">Others</li>
                </ul>
            </nav>
        </div>
    </div>
    <button id="scrollTopBtn" style="display:none;position:fixed;bottom:32px;right:16px;z-index:9999;background:#b9b4e7;border:none;border-radius:50%;width:54px;height:54px;box-shadow:0 2px 12px #e0e0e0;cursor:pointer;align-items:center;justify-content:center;transition:opacity 0.3s;">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="12" fill="#b9b4e7"/>
            <path d="M8 14l4-4 4 4" stroke="#5a4e7c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </button>
    <button id="whatsappBtn" style="display:flex;position:fixed;bottom:100px;right:16px;z-index:9999;background:#25d366;border:none;border-radius:50%;width:54px;height:54px;box-shadow:0 2px 12px #0007;cursor:pointer;align-items:center;justify-content:center;transition:opacity 0.3s;">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="16" cy="16" r="16" fill="#25d366"/>
            <path d="M23 16.5c0-4.142-3.358-7.5-7.5-7.5s-7.5 3.358-7.5 7.5c0 1.326.347 2.57.95 3.646L8 24l3.972-1.312A7.47 7.47 0 0 0 15.5 24c4.142 0 7.5-3.358 7.5-7.5zm-7.5 6.5c-1.13 0-2.19-.293-3.104-.805l-.221-.13-2.36.78.78-2.36-.13-.221A6.48 6.48 0 0 1 9 16.5c0-3.584 2.916-6.5 6.5-6.5s6.5 2.916 6.5 6.5-2.916 6.5-6.5 6.5zm3.35-4.05c-.184-.092-1.09-.537-1.257-.598-.168-.062-.29-.092-.413.092-.123.184-.474.598-.581.723-.107.123-.215.138-.399.046-.184-.092-.777-.286-1.48-.911-.545-.486-.913-1.086-1.02-1.27-.107-.184-.012-.283.08-.375.082-.081.184-.215.276-.323.092-.107.123-.184.184-.307.062-.123.031-.23-.016-.323-.046-.092-.414-1.07-.567-1.465-.153-.395-.299-.34-.413-.347-.107-.005-.23-.006-.353-.006-.123 0-.323.046-.492.23-.168.184-.638.573-.638 1.398 0 .825.573 1.623.653 1.739.08.115 1.127 1.72 2.73 2.347.382.132.68.211.914.27.384.092.734.079 1.011.048.308-.034.949-.388 1.084-.763.134-.375.134-.696.094-.763-.04-.067-.153-.107-.32-.184z" fill="#fff"/>
        </svg>
    </button>
    <div id="addToCartMsg" class="add-to-cart-msg"></div>
    <div class="container" id="mainContainer">
        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙŠØªØºÙŠØ± Ù‡Ù†Ø§ -->
    </div>
    <div id="adminLoginModal" class="admin-login-modal" style="display:none;">
        <div class="admin-login-box">
            <h2>Admin Login</h2>
            <input type="text" id="adminUsername" placeholder="Username">
            <input type="password" id="adminPassword" placeholder="Password">
            <button id="adminLoginBtn">Login</button>
            <div class="error" id="adminLoginError"></div>
        </div>
    </div>
    <script>
        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù„ÙˆØ¯Ø± Ù„Ù…Ø¯Ø© 3 Ø«ÙˆØ§Ù†ÙŠ ÙÙ‚Ø· Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('DOMContentLoaded', function() {
            var loader = document.getElementById('mainLoader');
            if(loader) {
                loader.style.display = 'flex';
                loader.style.opacity = '1';
                setTimeout(function() {
                    loader.style.opacity = '0';
                    setTimeout(function() {
                        loader.style.display = 'none';
                    }, 400); // Ù†ÙØ³ Ù…Ø¯Ø© transition
                }, 3000); // 3 Ø«ÙˆØ§Ù†ÙŠ
            }
        });
        // --- Firebase config ---
        const firebaseConfig = {
            apiKey: "AIzaSyABBNyziST2TOTr1YQv7nEAq_V1LVoymo0",
            authDomain: "abo-elela.firebaseapp.com",
            databaseURL: "https://abo-elela-default-rtdb.firebaseio.com",
            projectId: "abo-elela",
            storageBucket: "abo-elela.firebasestorage.app",
            messagingSenderId: "1094481849658",
            appId: "1:1094481849658:web:111289c004cfcfc9ef7403",
            measurementId: "G-V22KTTMVD8"
        };
        firebase.initializeApp(firebaseConfig);
        if (firebase.analytics) firebase.analytics();
        const db = firebase.database();

        // --- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Firebase ---
        let products = [];
        let editingProductIndex = null;
        const productTypes = [
            {key: 'creatine', label: 'Creatine'},
            {key: 'protein', label: 'Protein'},
            {key: 'gainer', label: 'Gainer'},
            {key: 'offers', label: 'Offers'},
            {key: 'others', label: 'Others'}
        ];
        // --- Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª ---
        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]'); // [{name, type}]
        function saveFavorites() {
            localStorage.setItem('favorites', JSON.stringify(favorites));
        }
        function isFavorite(prod) {
            return favorites.some(f => f.name === prod.name && f.type === prod.type);
        }
        function toggleFavorite(name, type) {
            const idx = favorites.findIndex(f => f.name === name && f.type === type);
            if(idx > -1) {
                favorites.splice(idx, 1);
            } else {
                favorites.push({name, type});
            }
            saveFavorites();
            updateFavoritesCount();
            const activeSection = document.querySelector('.navbar li.active')?.getAttribute('data-section');
            // Ø¥Ø°Ø§ ÙƒÙ†Ø§ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø§ØªØŒ Ø­Ø¯Ø«Ù‡Ø§ ÙÙ‚Ø· ÙˆÙ„Ø§ ØªØ°Ù‡Ø¨ Ù„Ø£ÙŠ ØµÙØ­Ø© Ø£Ø®Ø±Ù‰
            if (activeSection === 'favorites' || document.getElementById('mainContainer')?.querySelector('.section-title')?.textContent === 'Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª') {
                renderFavoritesSection();
            } else {
                renderProductsSection(activeSection);
            }
        }
        function updateFavoritesCount() {
            const favCount = document.getElementById('favoritesCount');
            if(favCount) favCount.innerText = favorites.length;
        }
        updateFavoritesCount();
        // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªØ­Ø¯ÙŠØ«Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        function listenToProducts() {
            db.ref('gymProducts').on('value', snapshot => {
                const val = snapshot.val() || {};
                // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø³ØªÙƒÙˆÙ† ÙƒÙƒØ§Ø¦Ù† (id -> product)
                products = Object.values(val);
                // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
                const activeSection = document.querySelector('.navbar li.active')?.getAttribute('data-section') || 'creatine';
                renderProductsSection(activeSection);
                // Ø¥Ø°Ø§ ÙƒÙ†Ø§ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†ØŒ Ø­Ø¯Ø« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                if (document.getElementById('adminProductsList')) renderAdminProductsList();
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ¯Ø± Ø¨Ø¹Ø¯ Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª
                const loader = document.getElementById('mainLoader');
                if(loader) {
                    loader.style.opacity = '0';
                    setTimeout(()=>{ loader.style.display = 'none'; }, 400);
                }
            });
        }
        listenToProducts();

        // Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function saveProductsToDB() {
            db.ref('gymProducts').set(products);
        }

        // --- Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„ØµÙˆØ± ÙˆØªÙƒØ¨ÙŠØ±Ù‡Ø§ ---
        function showImageModalForProduct(prod, startIdx = 0) {
            if (!prod.images || !prod.images.length) return;
            let currentIdx = startIdx;
            let modal = document.createElement('div');
            modal.style.position = 'fixed';
            modal.style.top = 0;
            modal.style.left = 0;
            modal.style.right = 0;
            modal.style.bottom = 0;
            modal.style.background = 'rgba(0,0,0,0.85)';
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.zIndex = 99999;
            // Ø¨Ù†Ø§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ‚Ù„ÙŠØ¨ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø£ÙƒØ«Ø± Ù…Ù† ØµÙˆØ±Ø©
            let arrowsHtml = '';
            if (prod.images.length > 1) {
                arrowsHtml = `
                    <button id="prevImgBtn" style="position:absolute;left:10px;top:50%;transform:translateY(-50%);background:#fff8;border:none;border-radius:50%;width:38px;height:38px;font-size:2rem;cursor:pointer;z-index:10;opacity:0.85;">â€¹</button>
                    <button id="nextImgBtn" style="position:absolute;right:10px;top:50%;transform:translateY(-50%);background:#fff8;border:none;border-radius:50%;width:38px;height:38px;font-size:2rem;cursor:pointer;z-index:10;opacity:0.85;">â€º</button>
                `;
            }
            modal.innerHTML = `
                <div id="modalImageSlider" style="position:relative;display:flex;flex-direction:column;align-items:center;">
                    <button id="closeModalBtn" style="position:absolute;top:-30px;right:0;background:#fff;border:none;border-radius:50%;width:32px;height:32px;font-size:1.3rem;cursor:pointer;z-index:10;">Ã—</button>
                    <div style="position:relative;display:flex;align-items:center;justify-content:center;">
                        <img id="modalImg" src="${prod.images[currentIdx]}" style="max-width:80vw;max-height:70vh;border-radius:12px;border:4px solid #ec35e3;box-shadow:0 2px 16px #0007;" />
                        ${arrowsHtml}
                    </div>
                    <div id="imgCounter" style="margin-top:18px;color:#fff;font-size:1.2rem;font-weight:bold;text-shadow:0 2px 8px #000;">${currentIdx+1}/${prod.images.length}</div>
                </div>
            `;
            // Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
            modal.onclick = function(e) {
                if (e.target === modal || e.target.id === 'closeModalBtn') document.body.removeChild(modal);
            };
            document.body.appendChild(modal);
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ‚Ù„ÙŠØ¨ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£ÙƒØ«Ø± Ù…Ù† ØµÙˆØ±Ø©
            if (prod.images.length > 1) {
                const updateImg = () => {
                    modal.querySelector('#modalImg').src = prod.images[currentIdx];
                    modal.querySelector('#imgCounter').innerText = `${currentIdx+1}/${prod.images.length}`;
                };
                modal.querySelector('#prevImgBtn').onclick = function(e) {
                    e.stopPropagation();
                    currentIdx = (currentIdx - 1 + prod.images.length) % prod.images.length;
                    updateImg();
                };
                modal.querySelector('#nextImgBtn').onclick = function(e) {
                    e.stopPropagation();
                    currentIdx = (currentIdx + 1) % prod.images.length;
                    updateImg();
                };
            }
        }
        // --- ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© ---
        function renderProductsSection(typeKey) {
            // Ø­ÙØ¸ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø³ÙƒØ±ÙˆÙ„ Ù„ÙƒÙ„ Ø³ÙƒØ´Ù†
            if (!window.sectionScrollPositions) window.sectionScrollPositions = {};
            // Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ø³ÙƒØ´Ù† Ø§Ù„Ø³Ø§Ø¨Ù‚
            if (window.currentSectionKey) {
                window.sectionScrollPositions[window.currentSectionKey] = window.scrollY;
            }
            window.currentSectionKey = typeKey;

            const container = document.getElementById('mainContainer');
            const type = productTypes.find(t => t.key === typeKey);
            // Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø®ÙÙŠØ© ÙÙ‚Ø· + Ø§Ù„Ø¨Ø­Ø«
            const searchTerm = (window.currentSearchTerm || '').toLowerCase();
            const filtered = products.filter(p => 
                p.type === typeKey && 
                !p.hidden &&
                (
                    !searchTerm ||
                    (p.name && p.name.toLowerCase().includes(searchTerm)) ||
                    (p.desc && p.desc.toLowerCase().includes(searchTerm))
                )
            );
            let html = `<div class='section-title'>${type ? type.label : ''}</div>`;
            if(filtered.length === 0) {
                html += `<div style='text-align:center;'>No products in this section yet.</div>`;
                container.innerHTML = html;
                // Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù…Ù†ØªØ¬Ø§ØªØŒ Ù„Ø§ Ø¯Ø§Ø¹ÙŠ Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³ÙƒØ±ÙˆÙ„
                return;
            }
            // --- Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 4 Ù…Ù†ØªØ¬Ø§Øª ÙÙˆØ±Ù‹Ø§ ---
            let initialCount = filtered.length; // Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙˆØ±Ù‹Ø§ Ø¨Ø¯ÙˆÙ† delay
            let shown = Math.min(initialCount, filtered.length);
            html += `<div class='products-grid' id='productsGrid'></div>`;
            container.innerHTML = html;
            const grid = document.getElementById('productsGrid');
            // Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„Ù…Ù†ØªØ¬ (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚)
            function productCardHtml(prod, idx) {
                const fadeDelay = idx * 60; // 60ms Ù„ÙƒÙ„ Ø¨Ø·Ø§Ù‚Ø©
                let slider = '';
                if(prod.images && prod.images.length > 1) {
                    slider = `
                        <div class='img-slider' style='position:relative;'>
                            <img src='${prod.images[0]}' loading='lazy' class='slider-img' style='cursor:pointer;' onclick='window.showImageModalForProduct(products[${products.indexOf(prod)}],0)' data-slider-idx='0' data-prod-idx='${idx}'>
                            <button class='slider-btn left' onclick='event.stopPropagation();window.changeSlide(this,${idx},-1)' style='position:absolute;left:2px;top:50%;transform:translateY(-50%);background:#222a;padding:2px 8px;border:none;color:#fc03efff;font-size:1.2rem;cursor:pointer;border-radius:4px;'>â€¹</button>
                            <button class='slider-btn right' onclick='event.stopPropagation();window.changeSlide(this,${idx},1)' style='position:absolute;right:2px;top:50%;transform:translateY(-50%);background:#222a;padding:2px 8px;border:none;color:#fc03efff;font-size:1.2rem;cursor:pointer;border-radius:4px;'>â€º</button>
                        </div>`;
                } else {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· Ø£Ùˆ Ù…ØµÙÙˆÙØ© Ø§Ù„ØµÙˆØ± ØºÙŠØ± Ù…Ø¹Ø±ÙØ© Ø£Ùˆ ÙØ§Ø±ØºØ©
                    let imgSrc = (prod.images && prod.images.length > 0) ? prod.images[0] : '';
                    slider = imgSrc ? `<img src='${imgSrc}' loading='lazy' style='cursor:pointer;' onclick='window.showImageModalForProduct(products[${products.indexOf(prod)}],0)'>`
                                    : `<div style='width:180px;height:180px;background:#f0f0f0;border-radius:8px;border:2px solid #eec9d2;display:flex;align-items:center;justify-content:center;color:#ccc;'>No Image</div>`;
                }
                let discount = getDiscountPercent(prod.priceBefore, prod.priceAfter);
                let discountHtml = discount ? `<span style='background:#ff4444;color:#fff;padding:2px 8px;border-radius:6px;font-size:1rem;position:absolute;left:10px;top:10px;'>${discount}% OFF</span>` : '';
                let fav = isFavorite(prod);
                let heartBtn = `<button onclick='window.toggleFavorite("${prod.name.replace(/\"/g, '&quot;')}", "${prod.type}")' style='position:absolute;top:6px;right:0;background:none;border:none;cursor:pointer;z-index:10;'>
                        <svg width='32' height='32' viewBox='0 0 24 24' fill='${fav ? "#ff4444" : "none"}' stroke='#ff4444' stroke-width='2'><path d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/></svg>
                    </button>`;
                let availableHtml = (prod.available === false) ? `<div style='color:#ff4444;font-weight:bold;margin-top:6px;'>ØºÙŠØ± Ù…ØªÙˆÙØ±</div>` : '';
                return `
                    <div class='product-card' style='overflow:visible; --fade-delay:${fadeDelay}ms;'>
                        <div style='position:relative;'>
                            ${slider}
                            ${heartBtn}
                            ${discountHtml}
                            ${availableHtml}
                        </div>
                        <div class='product-title'>${prod.name}</div>
                        <div class='product-desc'>${prod.desc}</div>
                        <div class='product-type'>${type ? type.label : ''}</div>
                        <div class='product-prices'>
                            <del>${prod.priceBefore} Ø¬.Ù…</del> <span>${prod.priceAfter} Ø¬.Ù…</span>
                        </div>
                        ${(prod.available === false) ? '' : `<button class='add-to-cart-btn' onclick='addToCart(${JSON.stringify(prod)})' style='background:#25d366;color:#fff;font-weight:bold;padding:8px 0;border-radius:6px;width:100%;margin-top:8px;font-size:1.1rem;cursor:pointer;border:none;'>Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>`}
                    </div>
                `;
            }
            // Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©
            for(let i=0; i<filtered.length; i++) {
                grid.insertAdjacentHTML('beforeend', productCardHtml(filtered[i], i));
            }
            // --- Ø¥Ø¸Ù‡Ø§Ø± Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØªØ¯Ø±ÙŠØ¬ÙŠÙ‹Ø§ ---
            if(filtered.length > initialCount) {
                let nextIdx = initialCount;
                function showNextBatch() {
                    let batch = 4;
                    let end = Math.min(nextIdx + batch, filtered.length);
                    for(let i=nextIdx; i<end; i++) {
                        grid.insertAdjacentHTML('beforeend', productCardHtml(filtered[i], i));
                    }
                    nextIdx = end;
                    if(nextIdx < filtered.length) {
                        setTimeout(showNextBatch, 300);
                    }
                }
                setTimeout(showNextBatch, 300);
            }
            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø³ÙƒØ±ÙˆÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø³ÙƒØ´Ù† Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø­ÙÙˆØ¸Ù‹Ø§
            setTimeout(function() {
                if (window.sectionScrollPositions && window.sectionScrollPositions[typeKey] !== undefined) {
                    window.scrollTo({top: window.sectionScrollPositions[typeKey], behavior: 'auto'});
                } else {
                    window.scrollTo({top: 0, behavior: 'auto'});
                }
            }, 0);
        }
        // --- Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„ØµÙˆØ± ---
        window.changeSlide = function(btn, filteredIdx, dir) {
            // Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§
            const section = document.querySelector('.navbar li.active').getAttribute('data-section');
            const searchTerm = (window.currentSearchTerm || '').toLowerCase();
            const filtered = products.filter(p => 
                p.type === section && 
                !p.hidden &&
                (
                    !searchTerm ||
                    (p.name && p.name.toLowerCase().includes(searchTerm)) ||
                    (p.desc && p.desc.toLowerCase().includes(searchTerm))
                )
            );
            const prod = filtered[filteredIdx];
            let img = btn.parentElement.querySelector('.slider-img');
            let current = parseInt(img.getAttribute('data-slider-idx')) || 0;
            current = (current + dir + prod.images.length) % prod.images.length;
            img.src = prod.images[current];
            img.setAttribute('onclick', `showImageModal("${prod.images[current]}")`);
            img.setAttribute('data-slider-idx', current);
        }
        window.showImageModalForProduct = showImageModalForProduct;
        // --- Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… ---
        function getDiscountPercent(before, after) {
            before = parseFloat(before); after = parseFloat(after);
            if(!before || !after || after >= before) return '';
            return Math.round(100 * (before - after) / before);
        }
        // Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†
        function showAdminLogin() {
            document.getElementById('adminLoginModal').style.display = 'flex';
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminLoginError').innerText = '';
            document.querySelector('.admin-login-box h2').innerText = 'Admin Login';
            document.getElementById('adminUsername').placeholder = 'Username';
            document.getElementById('adminPassword').placeholder = 'Password';
            document.getElementById('adminLoginBtn').innerText = 'Login';
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
            var usernameInput = document.getElementById('adminUsername');
            var passwordInput = document.getElementById('adminPassword');
            var loginBtn = document.getElementById('adminLoginBtn');
            function tryLogin(e) {
                if (e.key === 'Enter') {
                    loginBtn.click();
                }
            }
            usernameInput.onkeydown = tryLogin;
            passwordInput.onkeydown = tryLogin;
        }
        function hideAdminLogin() {
            document.getElementById('adminLoginModal').style.display = 'none';
        }
        document.getElementById('adminBtn').onclick = showAdminLogin;
        document.getElementById('adminLoginBtn').onclick = function() {
            const user = document.getElementById('adminUsername').value.trim();
            const pass = document.getElementById('adminPassword').value.trim();
            if(user === '0' && pass === '0') {
                hideAdminLogin();
                renderAdminPanel();
            } else {
                document.getElementById('adminLoginError').innerText = 'Invalid login data';
            }
        };
        // Ø§ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.getElementById('adminLoginModal').onclick = function(e) {
            if(e.target === this) hideAdminLogin();
        };

        // Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
        function renderAdminPanel() {
            const container = document.getElementById('mainContainer');
            container.style.maxWidth = '';
            container.style.width = '';
            container.style.minWidth = '';
            let html = `<div class='admin-panel'>
                <h2>Admin Panel</h2>
                <div style='display:flex;gap:10px;flex-wrap:wrap;margin-bottom:18px;'>
                    <button class='add-product-btn' onclick='showProductForm()'>+ Add New Product</button>
                    <button class='add-product-btn' style='background:#25d366;' onclick='renderOrdersList()'>Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
                    <button class='add-product-btn' style='background:#007bff;' onclick='renderDiscountCodesPage()'>Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®ØµÙ…</button>
                    <button class='add-product-btn' style='background:#ffb300;color:#222;' onclick='renderAnalysisPanel()'>Analysis</button>
                </div>
                <div id='analysisPanelContainer'></div>
                <div id='productFormContainer' style='background:#007bff;margin-right:10px;'></div>
                <div class='products-list' id='adminProductsList'></div>
            </div>`;
            container.innerHTML = html;
            renderAdminProductsList();
        // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„
        function renderAnalysisPanel() {
            const analysisContainer = document.getElementById('analysisPanelContainer');
            if (!analysisContainer) return;
            // ÙÙ„Ø§ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®
            let html = `<div style='display:flex;gap:12px;align-items:center;margin-bottom:18px;flex-wrap:wrap;'>
                <label>Ù…Ù† ØªØ§Ø±ÙŠØ®: <input type='date' id='analysisFromDate' style='padding:4px 8px;border-radius:6px;border:1px solid #ccc;'/></label>
                <label>Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®: <input type='date' id='analysisToDate' style='padding:4px 8px;border-radius:6px;border:1px solid #ccc;'/></label>
                <button onclick='updateAnalysisPanel()' style='background:#25d366;color:#fff;font-weight:bold;padding:6px 18px;border-radius:8px;font-size:1rem;cursor:pointer;border:none;'>ÙÙ„ØªØ±Ø©</button>
                <button onclick='clearAnalysisFilters()' style='background:#ff4444;color:#fff;font-weight:bold;padding:6px 18px;border-radius:8px;font-size:1rem;cursor:pointer;border:none;'>Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±</button>
            </div>`;
            html += `<div id='analysisStatsBoxes' style='display:flex;gap:18px;flex-wrap:wrap;'></div>`;
            analysisContainer.innerHTML = html;
            updateAnalysisPanel();
        }

        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„
        function updateAnalysisPanel() {
            const statsBoxes = document.getElementById('analysisStatsBoxes');
            if (!statsBoxes) return;
            // Ø¬Ù„Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù…Ù† Ø§Ù„ÙÙ„Ø§ØªØ±
            let fromDate = document.getElementById('analysisFromDate')?.value;
            let toDate = document.getElementById('analysisToDate')?.value;
            let from = fromDate ? new Date(fromDate + 'T00:00:00') : null;
            let to = toDate ? new Date(toDate + 'T23:59:59') : null;

            // Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            let manCount = products.filter(p => p.type === 'man' && !p.hidden).length;
            let womanCount = products.filter(p => p.type === 'woman' && !p.hidden).length;
            let totalProducts = manCount + womanCount;

            // Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®ØµÙ…
            firebase.database().ref('discountCodes').once('value', snap => {
                const codes = Object.values(snap.val() || {});
                let discountCodesCount = codes.length;

                // Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                firebase.database().ref('orders').once('value', snap2 => {
                    const ordersArr = Object.values(snap2.val() || {});
                    // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
                    let filteredOrders = ordersArr;
                    if (from || to) {
                        filteredOrders = ordersArr.filter(order => {
                            if (!order.time) return false;
                            let orderDate = parseOrderDate(order.time);
                            if (!orderDate) return false;
                            if (from && orderDate < from) return false;
                            if (to && orderDate > to) return false;
                            return true;
                        });
                    }
                    let cancelled = filteredOrders.filter(o => o.status === 'Ù…Ù„ØºÙŠ').length;
                    let pending = filteredOrders.filter(o => !o.status || o.status === 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±' || o.status === 'pending').length;
                    let delivered = filteredOrders.filter(o => o.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„').length;

                    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª
                    let statsHtml = `
                        <!-- <div style='background:#fff;border-radius:12px;box-shadow:0 2px 8px #e0e0e0;padding:18px 24px;min-width:180px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center;'>
                            <div style='font-size:1.2rem;color:#784fe7;font-weight:bold;'>Ù…Ù†ØªØ¬Ø§Øª Man</div>
                            <div style='font-size:2.1rem;font-weight:bold;color:#232323;'>${manCount}</div>
                        </div> -->
                        <!-- <div style='background:#fff;border-radius:12px;box-shadow:0 2px 8px #e0e0e0;padding:18px 24px;min-width:180px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center;'>
                            <div style='font-size:1.2rem;color:#784fe7;font-weight:bold;'>Ù…Ù†ØªØ¬Ø§Øª Woman</div>
                            <div style='font-size:2.1rem;font-weight:bold;color:#232323;'>${womanCount}</div>
                        </div> -->
                        <!-- <div style='background:#fff;border-radius:12px;box-shadow:0 2px 8px #e0e0e0;padding:18px 24px;min-width:180px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center;'>
                            <div style='font-size:1.2rem;color:#784fe7;font-weight:bold;'>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                            <div style='font-size:2.1rem;font-weight:bold;color:#232323;'>${totalProducts}</div>
                        </div> -->
                        <div style='background:#fff;border-radius:12px;box-shadow:0 2px 8px #e0e0e0;padding:18px 24px;min-width:180px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center;'>
                            <div style='font-size:1.2rem;color:#25d366;font-weight:bold;'>Ø¹Ø¯Ø¯ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®ØµÙ…</div>
                            <div style='font-size:2.1rem;font-weight:bold;color:#25d366;'>${discountCodesCount}</div>
                        </div>
                        <div style='background:#fff;border-radius:12px;box-shadow:0 2px 8px #e0e0e0;padding:18px 24px;min-width:180px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center;'>
                            <div style='font-size:1.2rem;color:#ff4444;font-weight:bold;'>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù„ØºÙŠØ©</div>
                            <div style='font-size:2.1rem;font-weight:bold;color:#ff4444;'>${cancelled}</div>
                        </div>
                        <div style='background:#fff;border-radius:12px;box-shadow:0 2px 8px #e0e0e0;padding:18px 24px;min-width:180px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center;'>
                            <div style='font-size:1.2rem;color:#ffb300;font-weight:bold;'>Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                            <div style='font-size:2.1rem;font-weight:bold;color:#ffb300;'>${pending}</div>
                        </div>
                        <div style='background:#fff;border-radius:12px;box-shadow:0 2px 8px #e0e0e0;padding:18px 24px;min-width:180px;min-height:90px;display:flex;flex-direction:column;align-items:center;justify-content:center;'>
                            <div style='font-size:1.2rem;color:#25d366;font-weight:bold;'>ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</div>
                            <div style='font-size:2.1rem;font-weight:bold;color:#25d366;'>${delivered}</div>
                        </div>
                    `;
                    statsBoxes.innerHTML = statsHtml;
                });
            });
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±
        function clearAnalysisFilters() {
            document.getElementById('analysisFromDate').value = '';
            document.getElementById('analysisToDate').value = '';
            updateAnalysisPanel();
        }

        // Ø¯Ø§Ù„Ø© Ù„ØªØ­ÙˆÙŠÙ„ Ù†Øµ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¥Ù„Ù‰ ÙƒØ§Ø¦Ù† Date (ÙŠØ¯Ø¹Ù… toLocaleString)
        function parseOrderDate(str) {
            // ÙŠØ­Ø§ÙˆÙ„ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®
            // ÙŠÙ‚Ø¨Ù„ ØµÙŠØº Ù…Ø«Ù„: 7/26/2025, 12:34:56 PM
            let d = new Date(str);
            if (!isNaN(d)) return d;
            // Ø¥Ø°Ø§ ÙØ´Ù„ØŒ Ø¬Ø±Ø¨ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù†Øµ
            let parts = str.split(',');
            if (parts.length > 1) {
                let datePart = parts[0].trim();
                let timePart = parts[1].trim();
                let d2 = new Date(datePart + 'T' + timePart);
                if (!isNaN(d2)) return d2;
            }
            return null;
        }

        // Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
        window.renderAnalysisPanel = renderAnalysisPanel;
        window.updateAnalysisPanel = updateAnalysisPanel;
        window.clearAnalysisFilters = clearAnalysisFilters;
        }

        // Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬
        function showProductForm(editIndex = null) {
            editingProductIndex = editIndex;
            let prod = {name:'', desc:'', images:[], priceBefore:'', priceAfter:'', type:productTypes[0].key, available:true};
            if(editIndex !== null) prod = products[editIndex];
            // Ù…ØªØºÙŠØ± Ù„Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØµÙˆØ±
            let currentImages = prod.images ? [...prod.images] : [];
            let html = `<form class='product-form' id='productForm'>
                <label>Product Name</label>
                <input type='text' name='name' value='${prod.name || ''}' required>
                <label>Description</label>
                <textarea name='desc' rows='2' required>${prod.desc || ''}</textarea>
                <label>Image Links (one per line)</label>
                <textarea name='imageLinks' rows='3' placeholder='Ø¶Ø¹ ÙƒÙ„ Ù„ÙŠÙ†Ùƒ ØµÙˆØ±Ø© ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„' required>${currentImages.join('\n')}</textarea>
                <div id='previewImages' style='display:flex;gap:8px;margin-bottom:8px;'></div>
                <label>Price Before Discount</label>
                <input type='number' name='priceBefore' value='${prod.priceBefore || ''}' required>
                <label>Price After Discount</label>
                <input type='number' name='priceAfter' value='${prod.priceAfter || ''}' required>
                <label>Product Type</label>
                <select name='type'>
                    ${productTypes.map(t=>`<option value='${t.key}' ${prod.type===t.key?'selected':''}>${t.label}</option>`).join('')}
                </select>
                <label>Ù…ØªÙˆÙØ±ØŸ</label>
                <select name='available'>
                    <option value='true' ${prod.available!==false?'selected':''}>Ù…ØªÙˆÙØ±</option>
                    <option value='false' ${prod.available===false?'selected':''}>ØºÙŠØ± Ù…ØªÙˆÙØ±</option>
                </select>
                <button type='submit'>${editIndex!==null?'Edit Product':'Add Product'}</button>
                <button type='button' onclick='hideProductForm()' style='margin-right:10px;background:#333;color:#fff;'>Cancel</button>
            </form>`;
            document.getElementById('productFormContainer').innerHTML = html;
            // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
            if(currentImages.length) {
                showPreviewImages(currentImages);
            }
            // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ± Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
            document.querySelector('#productForm textarea[name="imageLinks"]').addEventListener('input', function(e) {
                const links = this.value.split('\n').map(x=>x.trim()).filter(Boolean);
                currentImages = links;
                showPreviewImages(currentImages);
            });
            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
            document.getElementById('productForm').onsubmit = function(e) {
                e.preventDefault();
                const fd = new FormData(this);
                let images = fd.get('imageLinks').split('\n').map(x=>x.trim()).filter(Boolean);
                let newProd = {
                    name: fd.get('name'),
                    desc: fd.get('desc'),
                    images: images,
                    priceBefore: fd.get('priceBefore'),
                    priceAfter: fd.get('priceAfter'),
                    type: fd.get('type'),
                    available: fd.get('available') === 'true'
                };
                saveProductData(newProd);
            };
        }
        function showPreviewImages(imgs) {
            const preview = document.getElementById('previewImages');
            preview.innerHTML = '';
            imgs.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                img.style.width = '50px';
                img.style.height = '50px';
                img.style.objectFit = 'cover';
                img.style.borderRadius = '5px';
                img.style.border = '1px solid #ffb300';
                preview.appendChild(img);
            });
        }
        function hideProductForm() {
            var el = document.getElementById('productFormContainer');
            if (el) el.innerHTML = '';
        }
        function saveProductData(prod) {
            if(editingProductIndex !== null) {
                // ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬: Ø­Ø¯Ø« Ø§Ù„Ù…ØµÙÙˆÙØ© ÙˆØ§Ø­ÙØ¸Ù‡Ø§ ÙƒØ§Ù…Ù„Ø©
                products[editingProductIndex] = prod;
                saveProductsToDB();
                editingProductIndex = null;
                hideProductForm();
                renderAdminProductsList();
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯: Ø§Ø³ØªØ®Ø¯Ù… push ÙÙŠ Firebase
                db.ref('gymProducts').push(prod, function(error) {
                    if (!error) {
                        hideProductForm();
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©
                        listenToProducts();
                    } else {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬!');
                    }
                });
            }
        }
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
        function renderAdminProductsList() {
            const list = document.getElementById('adminProductsList');
            if (!list) return;
            if(!products.length) {
                list.innerHTML = '<div style="text-align:center;">No products yet.</div>';
                return;
            }
            let html = '';
            products.forEach((prod, i) => {
                const type = productTypes.find(t=>t.key===prod.type);
                let hideBtn = prod.hidden 
                    ? `<button title='Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬' onclick='toggleHideProduct(${i})'>
                        <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M1 12C2.73 7.61 7.09 4.5 12 4.5C16.91 4.5 21.27 7.61 23 12C21.27 16.39 16.91 19.5 12 19.5C7.09 19.5 2.73 16.39 1 12Z' stroke='#ffb300' stroke-width='2'/><circle cx='12' cy='12' r='3.5' stroke='#ffb300' stroke-width='2'/></svg>
                    </button>`
                    : `<button title='Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ù†ØªØ¬' onclick='toggleHideProduct(${i})'>
                        <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M17.94 17.94C16.13 19.24 14.13 20 12 20C7.09 20 2.73 16.39 1 12C1.73 10.19 2.91 8.61 4.44 7.36M9.9 5.08C10.59 4.86 11.29 4.73 12 4.73C16.91 4.73 21.27 8.34 23 13C22.27 14.81 21.09 16.39 19.56 17.64M1 1L23 23' stroke='#ffb300' stroke-width='2'/><circle cx='12' cy='12' r='3.5' stroke='#ffb300' stroke-width='2'/></svg>
                    </button>`;
                html += `<div class='product-card' draggable='true' data-index='${i}'
                    ondragstart='onAdminProductDragStart(event, ${i})'
                    ondragover='onAdminProductDragOver(event, ${i})'
                    ondrop='onAdminProductDrop(event, ${i})'
                    ondragend='onAdminProductDragEnd(event)'
                    style='opacity:1;transition:opacity 0.2s;'>
                    <span class='drag-handle' style='cursor:grab;font-size:2rem;color:#ffb300;user-select:none;margin-right:8px;' title='Ø§Ø³Ø­Ø¨ Ù„Ù„ØªØ±ØªÙŠØ¨'>â˜°</span>
                    <img src="${prod.images[0] || ''}" loading="lazy" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬" style="cursor:pointer;" onclick="showImageModal('${prod.images[0]}')">
                    <div class='product-info'>
                        <div class='product-title'>${prod.name}</div>
                        <div class='product-desc'>${prod.desc}</div>
                        <div class='product-prices'><del>${prod.priceBefore} Ø¬.Ù…</del> <span>${prod.priceAfter} Ø¬.Ù…</span></div>
                        <div class='product-actions'>
                            <button title='ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬' onclick='editProduct(${i})'>
                                <svg width='22' height='22' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M4 21H20' stroke='#ffb300' stroke-width='2'/><path d='M18.5 2.5C18.8978 2.10218 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10218 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10218 21.5 5.5L7 20L2 21L3 16L18.5 2.5Z' stroke='#ffb300' stroke-width='2'/></svg>
                            </button>
                            <button title='Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬' onclick='deleteProduct(${i})'>
                                <svg width='22' height='22' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M3 6H5H21' stroke='#ffb300' stroke-width='2'/><path d='M8 6V4C8 2.89543 8.89543 2 10 2H14C15.1046 2 16 2.89543 16 4V6M19 6V20C19 21.1046 18.1046 22 17 22H7C5.89543 22 5 21.1046 5 20V6M10 11V17M14 11V17' stroke='#ffb300' stroke-width='2'/></svg>
                            </button>
                            ${hideBtn}
                        </div>
                    </div>
                </div>`;
            });
            list.innerHTML = html;
        }
        // --- Drag & Drop Ù„Ù„Ø£Ø¯Ù…Ù† ---
        let dragSrcIndex = null;
        window.onAdminProductDragStart = function(e, idx) {
            dragSrcIndex = idx;
            e.dataTransfer.effectAllowed = 'move';
            e.currentTarget.style.opacity = '0.4';
        };
        window.onAdminProductDragOver = function(e, idx) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        };
        window.onAdminProductDrop = function(e, idx) {
            e.preventDefault();
            if (dragSrcIndex === null || dragSrcIndex === idx) return;
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            const moved = products.splice(dragSrcIndex, 1)[0];
            products.splice(idx, 0, moved);
            dragSrcIndex = null;
            saveProductsToDB();
            renderAdminPanel();
        };
        window.onAdminProductDragEnd = function(e) {
            e.currentTarget.style.opacity = '1';
            dragSrcIndex = null;
        };
        // Ø²Ø± Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬
        window.toggleHideProduct = function(i) {
            products[i].hidden = !products[i].hidden;
            saveProductsToDB();
            renderAdminProductsList();
        }
        // ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬
        window.editProduct = function(i) {
            showProductForm(i);
        }
        // Ø­Ø°Ù Ù…Ù†ØªØ¬
        window.deleteProduct = function(i) {
            if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) {
                products.splice(i,1);
                saveProductsToDB();
                renderAdminProductsList();
            }
        }
        // Ø±Ø¨Ø· Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù†Ø§Ø¨ Ø¨Ø§Ø±
        document.querySelectorAll('.navbar li[data-section]').forEach(li => {
            li.onclick = function() {
                document.querySelectorAll('.navbar li').forEach(l=>l.classList.remove('active'));
                this.classList.add('active');
                // Ø§Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù‚Ø³Ù…
                document.getElementById('searchInput').value = '';
                window.currentSearchTerm = '';
                const section = this.getAttribute('data-section');
                if(section === 'admin') {
                    showAdminLogin();
                } else {
                    renderProductsSection(section);
                }
            }
        });
        // Ø¹Ø±Ø¶ Ù‚Ø³Ù… man Ø§ÙØªØ±Ø§Ø¶ÙŠØ§
        renderProductsSection('creatine');
        // Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰
        const scrollTopBtn = document.getElementById('scrollTopBtn');
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            if(window.scrollY > navbar.offsetHeight + 30) {
                scrollTopBtn.style.display = 'flex';
                scrollTopBtn.style.opacity = '1';
            } else {
                scrollTopBtn.style.opacity = '0';
                setTimeout(()=>{scrollTopBtn.style.display = 'none';}, 300);
            }
        });
        scrollTopBtn.onclick = function() {
            window.scrollTo({top:0, behavior:'smooth'});
        }
        // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
        window.currentSearchTerm = '';
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                window.currentSearchTerm = this.value;
                // Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
                const activeSection = document.querySelector('.navbar li.active')?.getAttribute('data-section') || 'man';
                renderProductsSection(activeSection);
            });
        }
        // Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¦Ù…
        const whatsappBtn = document.getElementById('whatsappBtn');
        if (whatsappBtn) {
            whatsappBtn.onclick = function() {
                window.open('https://wa.me/201121366757', '_blank');
            };
        }
    </script>
    <!-- Splash Screen Animation -->
    <script>
        window.addEventListener('DOMContentLoaded', function() {
            const splash = document.getElementById('splashScreen');
            const logo = document.getElementById('splashLogo');
            const loader = document.getElementById('mainLoader');
            if (splash && logo) {
                // Step 1: Shake
                logo.style.animation = 'shake 0.7s cubic-bezier(.36,.07,.19,.97) both';
                setTimeout(() => {
                    // Step 2: Drop Down
                    logo.style.animation = 'dropDown 0.9s cubic-bezier(.36,.07,.19,.97) forwards';
                    setTimeout(() => {
                        // Step 3: Hide splash and show page
                        splash.style.opacity = '0';
                        setTimeout(() => {
                            splash.style.display = 'none';
                            // Ø¨Ø¹Ø¯ Ø§Ø®ØªÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ¬ÙˆØŒ Ø£Ø¸Ù‡Ø± Ø§Ù„Ù„ÙˆØ¯Ø±
                            if(loader) {
                                loader.style.display = 'flex';
                                loader.style.opacity = '1';
                            }
                        }, 400);
                    }, 900);
                }, 700);
            }
        });
    </script>
    <script>
        // --- Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ù„Ø© ---
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        let cartShakeInterval = null;
        function updateCartCount() {
            document.getElementById('cartCount').innerText = cart.length;
            // Ø§Ù‡ØªØ²Ø§Ø² Ø§Ù„Ø³Ù„Ø© ÙƒÙ„ 3 Ø«ÙˆØ§Ù†ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³Ù„Ø© ØºÙŠØ± ÙØ§Ø±ØºØ©
            const cartBtn = document.getElementById('cartBtn');
            if(cart.length > 0) {
                if(!cartShakeInterval) {
                    cartShakeInterval = setInterval(() => {
                        if(cartBtn) {
                            cartBtn.classList.add('shake-cart');
                            setTimeout(()=>cartBtn.classList.remove('shake-cart'), 600);
                        }
                    }, 3000);
                }
            } else {
                if(cartShakeInterval) {
                    clearInterval(cartShakeInterval);
                    cartShakeInterval = null;
                }
            }
            // Ø­ÙØ¸ Ø§Ù„Ø³Ù„Ø© ÙÙŠ localStorage
            localStorage.setItem('cart', JSON.stringify(cart));
        }
        function addToCart(prod) {
            // Ø£Ø¶Ù Ø§Ù„Ù…Ù†ØªØ¬ ÙƒÙ…Ø§ Ù‡Ùˆ (Ø­ØªÙ‰ Ù„Ùˆ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù†ÙˆØ¹ Ù…ØªÙƒØ±Ø±ÙŠÙ†)
            cart.push({ ...prod, qty: 1 });
            updateCartCount();
            // Ø±Ø³Ø§Ù„Ø© Ø¹Ø§Ø¦Ù…Ø©
            showAddToCartMessage(prod.name);
        }
        // Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„Ø³Ù„Ø©
        function renderCartPage() {
            const container = document.getElementById('mainContainer');
            if(cart.length === 0) {
                container.innerHTML = `<div class='section-title'>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</div><div style='text-align:center;'>. Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>`;
                return;
            }
            let html = `<div class='section-title'>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</div><div class='products-list'>`;
            cart.forEach((item, i) => {
                html += `<div class='product-card' style='flex-direction:row;align-items:center;'>
                    <img src='${(item.images && item.images[0]) ? item.images[0] : ''}' style='width:80px;height:80px;object-fit:cover;border-radius:8px;margin-left:12px;'>
                    <div class='product-info' style='flex:1;'>
                        <div class='product-title'>${item.name}</div>
                        <div class='product-desc'>${item.desc}</div>
                        <div class='product-type'>${item.type}</div>
                        <div class='product-prices'><span>${item.priceAfter} Ø¬.Ù…</span></div>
                    </div>
                    <div style='display:flex;flex-direction:column;align-items:center;gap:6px;'>
                        <button onclick='changeCartQty(${i},1)' style='background:#85f170;color:#ecf1eb;border:none;border-radius:50%;width:32px;height:32px;font-size:1.3rem;font-weight:bold;cursor:pointer;'>+</button>
                        <span style='font-size:1.2rem;font-weight:bold;'>${item.qty}</span>
                        <button onclick='changeCartQty(${i},-1)' style='background:#ff2a04;color:#ecf1eb;border:none;border-radius:50%;width:32px;height:32px;font-size:1.3rem;font-weight:bold;cursor:pointer;'>-</button>
                    </div>
                </div>`;
            });
            html += `</div>`;
            // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø±
            let total = cart.reduce((sum, item) => sum + (parseFloat(item.priceAfter) * (item.qty || 1)), 0);
            html += `<div style='text-align:center;font-size:1.3rem;margin:18px 0;color:#ff2a04;'>Ø¬.Ù… ${total}  <span style='color:#000000;;font-weight:bold;'> : Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø± </span></div>`;
            html += `<div style='text-align:center;'><button onclick='showOrderForm()' class='btn-modern'>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button></div>`;
            container.innerHTML = html;
        }
        function changeCartQty(idx, delta) {
            cart[idx].qty += delta;
            if(cart[idx].qty <= 0) cart.splice(idx,1);
            updateCartCount();
            renderCartPage();
        }
        // Ø²Ø± Ø§Ù„Ø³Ù„Ø©
        document.getElementById('cartBtn').onclick = renderCartPage;
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        updateCartCount();
        // --- ÙÙˆØ±Ù… Ø§Ù„Ø·Ù„Ø¨ ---
        function showOrderForm() {
            const container = document.getElementById('mainContainer');
            let html = `<div class='section-title'>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</div>
                <form id='orderForm' class='order-form-modern'>
                    <div class='form-group'>
                        <input type='text' name='name' id='orderName' placeholder=' ' required autocomplete='off'/>
                        <label for='orderName'>Ø§Ù„Ø§Ø³Ù…</label>
                    </div>
                    <div class='form-group'>
                        <input type='text' id='whatsappInput' name='whatsapp' placeholder=' ' required maxlength='11' pattern='[0-9]{11}' autocomplete='off'/>
                        <label for='whatsappInput'>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
                        <div id='whatsappError' class='error-msg' style='display:none;'></div>
                    </div>
                    <div class='form-group'>
                        <input type='text' id='phone2Input' name='phone2' placeholder=' ' maxlength='11' pattern='[0-9]{11}' autocomplete='off'/>
                        <label for='phone2Input'>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø¥Ø¶Ø§ÙÙŠ </label>
                        <div id='phone2Error' class='error-msg' style='display:none;'></div>
                    </div>
                    <div class='form-group' style='position:relative;'>
                        <input type='text' name='governorate' id='governorateInput' placeholder=' ' required autocomplete='off' style='width:95%;padding:18px 12px 10px 12px;border:1.5px solid #eec9d2;border-radius:8px;font-size:1.15rem;background:#faf9f6;color:#5a4e7c;outline:none;transition:border 0.2s,box-shadow 0.2s;box-shadow:0 2px 8px #eec9d2;' />
                        <label for='governorateInput'>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
                        <div id='governorateError' class='error-msg' style='display:none;'></div>
                        <ul id='governorateList' style='position:absolute;top:100%;right:0;left:0;z-index:10;background:#fff;border:1px solid #eec9d2;border-radius:8px;max-height:180px;overflow-y:auto;box-shadow:0 2px 8px #eec9d2;display:none;margin:2px 0 0 0;padding:0;list-style:none;'></ul>
                    </div>
                    <div class='form-group'>
                        <textarea name='address' id='orderAddress' placeholder=' ' required></textarea>
                        <label for='orderAddress'>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„</label>
                    </div>
                    <div class='form-group'>
                        <input type='text' id='discountCodeInput' name='discountCode' placeholder=' ' maxlength='6'/>
                        <label for='discountCodeInput'>Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <div id='discountCodeMsg' class='success-msg' style='display:none;'></div>
                        <div id='discountCodeError' class='error-msg' style='display:none;'></div>
                    </div>
                    <div id='orderTotalBox'></div>
                    <button type='submit'>ØªØ£ÙƒÙŠØ¯ Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø·Ù„Ø¨</button>
                </form>
                <br>
                <div id='giftSection'></div>`;
            container.innerHTML = html;
            // ØªØ­Ù‚Ù‚ Ù…Ø¨Ø§Ø´Ø± Ø¹Ù†Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø©
            const whatsappInput = document.getElementById('whatsappInput');
            const whatsappError = document.getElementById('whatsappError');
            whatsappInput.addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9]/g, '');
                if(this.value.length > 11) this.value = this.value.slice(0,11);
                if(this.value.length === 11) {
                    whatsappError.style.display = 'none';
                }
            });
            // ØªØ­Ù‚Ù‚ Ù…Ø¨Ø§Ø´Ø± Ø¹Ù†Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ
            const phone2Input = document.getElementById('phone2Input');
            const phone2Error = document.getElementById('phone2Error');
            phone2Input.addEventListener('input', function(e) {
                this.value = this.value.replace(/[^0-9]/g, '');
                if(this.value.length > 11) this.value = this.value.slice(0,11);
                if(this.value.length === 0 || this.value.length === 11) {
                    phone2Error.style.display = 'none';
                }
            });
            // ØªØ­Ù‚Ù‚ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©
            const governorateInput = document.getElementById('governorateInput');
            const governorateError = document.getElementById('governorateError');
            const governorateList = document.getElementById('governorateList');
            // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª
            const governorates = [
                'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©','Ø§Ù„Ø¬ÙŠØ²Ø©','Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©','Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©','Ø§Ù„Ø¨Ø­ÙŠØ±Ø©','Ø§Ù„Ø´Ø±Ù‚ÙŠØ©','Ø§Ù„ØºØ±Ø¨ÙŠØ©','Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©','Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©','ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®','Ø§Ù„ÙÙŠÙˆÙ…','Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ','Ø§Ù„Ù…Ù†ÙŠØ§','Ø£Ø³ÙŠÙˆØ·','Ø³ÙˆÙ‡Ø§Ø¬','Ù‚Ù†Ø§','Ø§Ù„Ø£Ù‚ØµØ±','Ø£Ø³ÙˆØ§Ù†','Ø¯Ù…ÙŠØ§Ø·','Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯','Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©','Ø§Ù„Ø³ÙˆÙŠØ³','Ù…Ø·Ø±ÙˆØ­','Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡','Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡','Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯','Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±'
            ];
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø©
            governorateInput.addEventListener('input', function() {
                const val = this.value.trim();
                let filtered = governorates.filter(g => g.includes(val));
                if (!val) filtered = governorates;
                if (filtered.length) {
                    governorateList.innerHTML = filtered.map(g => `<li style='padding:8px 12px;cursor:pointer;' data-gov='${g}'>${g}</li>`).join('');
                    governorateList.style.display = 'block';
                } else {
                    governorateList.style.display = 'none';
                }
            });
            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            governorateList.addEventListener('mousedown', function(e) {
                if (e.target.tagName === 'LI') {
                    governorateInput.value = e.target.getAttribute('data-gov');
                    governorateList.style.display = 'none';
                    updateOrderTotal();
                }
            });
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ØªØ±ÙƒÙŠØ²
            governorateInput.addEventListener('blur', function() {
                setTimeout(() => { governorateList.style.display = 'none'; }, 150);
            });
            // --- ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… ---
            let discountValue = 0;
            let discountCodeUsed = '';
            const discountCodeInput = document.getElementById('discountCodeInput');
            const discountCodeMsg = document.getElementById('discountCodeMsg');
            const discountCodeError = document.getElementById('discountCodeError');
            const orderTotalBox = document.getElementById('orderTotalBox');
            // Ø§Ù„Ø´Ø­Ù† Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©
            let shippingValue = 0;
            let shippingText = '';
            // --- Ø¬Ø²Ø¡ Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ ---
            let selectedGift = '';
            function renderGiftSection(total) {
                const giftSection = document.getElementById('giftSection');
                if (!giftSection) return;
                if (total >= 1000) {
                    // Ø¨Ù†Ø§Ø¡ ØµÙˆØ± Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
                    giftSection.innerHTML = '';
                    const title = document.createElement('div');
                    title.style.marginBottom = '8px';
                    title.style.fontWeight = 'bold';
                    title.style.color = '#a1589e';
                    title.style.textAlign = 'center';
                    title.textContent ='Ø§Ø®ØªØ± Ù‡Ø¯ÙŠØªÙƒ ( Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù€ 1000 Ø¬Ù†ÙŠÙ‡ Ø£Ùˆ Ø£ÙƒØ«Ø± )';
                    giftSection.appendChild(title);
                    const row = document.createElement('div');
                    row.className = 'gift-row';
                    row.style.display = 'flex';
                    row.style.flexDirection = 'row';
                    row.style.gap = '16px';
                    row.style.justifyContent = 'center';
                    row.style.alignItems = 'center';
                    row.style.marginBottom = '10px';
                    const gifts = ['img1.jpg','img2.jpg','img3.jpg'];
                    gifts.forEach(function(img) {
                        const label = document.createElement('label');
                        label.style.cursor = 'pointer';
                        label.style.display = 'flex';
                        label.style.flexDirection = 'column';
                        label.style.alignItems = 'center';
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = 'gift';
                        input.value = img;
                        input.style.display = 'none';
                        const image = document.createElement('img');
                        image.src = img;
                        image.style.width = '70px';
                        image.style.height = '70px';
                        image.style.objectFit = 'cover';
                        image.style.borderRadius = '8px';
                        image.style.border = '2px solid #eec9d2';
                        image.style.transition = 'box-shadow 0.2s';
                        image.className = 'gift-img';
                        label.appendChild(input);
                        label.appendChild(image);
                        row.appendChild(label);
                    });
                    giftSection.appendChild(row);
                    const errorDiv = document.createElement('div');
                    errorDiv.id = 'giftError';
                    errorDiv.className = 'error-msg';
                    errorDiv.style.display = 'none';
                    giftSection.appendChild(errorDiv);
                    // ØªÙØ¹ÙŠÙ„ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· Ù…Ø¹ ØªÙ…ÙŠÙŠØ²Ù‡Ø§
                    giftSection.querySelectorAll('input[name="gift"]').forEach(input => {
                        input.addEventListener('change', function() {
                            selectedGift = this.value;
                            giftSection.querySelectorAll('.gift-img').forEach(img => img.style.boxShadow = '');
                            this.nextElementSibling.style.boxShadow = '0 0 0 4px #a1589e';
                        });
                    });
                } else {
                    giftSection.innerHTML = '';
                    selectedGift = '';
                }
            }
            function updateOrderTotal() {
                let total = cart.reduce((sum, item) => sum + (parseFloat(item.priceAfter) * (item.qty || 1)), 0);
                let afterDiscount = Math.max(0, total - discountValue);
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø­Ù† Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©
                const gov = governorateInput.value.trim();
                // Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª Ø¨Ø³Ø¹Ø± 85 Ø¬Ù†ÙŠÙ‡
                const gov85 = ['Ø§Ù„Ø´Ø±Ù‚ÙŠØ©','Ø§Ù„ØºØ±Ø¨ÙŠØ©','Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©','Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©','Ø§Ù„Ø¨Ø­ÙŠØ±Ø©','Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯','Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©','Ø§Ù„Ø³ÙˆÙŠØ³','ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®'];
                // Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª Ø¨Ø³Ø¹Ø± 99 Ø¬Ù†ÙŠÙ‡
                const gov99 = ['Ø§Ù„Ø£Ù‚ØµØ±','Ø£Ø³ÙˆØ§Ù†','Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯','Ø³ÙˆÙ‡Ø§Ø¬','Ø§Ù„Ù…Ù†ÙŠØ§','Ø£Ø³ÙŠÙˆØ·','Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®','Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡','Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±','Ù‚Ù†Ø§','Ù…Ø±Ø³ÙŠ Ù…Ø·Ø±ÙˆØ­','Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ','Ø§Ù„ÙÙŠÙˆÙ…','Ù…Ø±Ø³ÙŠ Ø¹Ù„Ù…'];
                if (gov === 'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©') {
                    shippingValue = 70;
                    shippingText = ' (70 Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø´Ø­Ù†)';
                } else if (gov === 'Ø§Ù„Ø¬ÙŠØ²Ø©') {
                    shippingValue = 75;
                    shippingText = ' (75 Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø´Ø­Ù†)';
                } else if (gov85.includes(gov)) {
                    shippingValue = 85;
                    shippingText = ' (85 Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø´Ø­Ù†)';
                } else if (gov99.includes(gov)) {
                    shippingValue = 99;
                    shippingText = ' (99 Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø´Ø­Ù†)';
                } else if (gov && governorates.includes(gov)) {
                    shippingValue = 85;
                    shippingText = ' (85 Ø¬Ù†ÙŠÙ‡ Ù„Ù„Ø´Ø­Ù†)';
                } else {
                    shippingValue = 0;
                    shippingText = '';
                }
                let finalTotal = afterDiscount + shippingValue;
                if (discountValue > 0) {
                    orderTotalBox.innerHTML = `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…${shippingText}: <span style='color:#25d366;'>${finalTotal} </span> <del style='color:#ff4444;font-size:1rem;margin-right:8px;'>${total + shippingValue} </del>`;
                } else {
                    orderTotalBox.innerHTML = `Ø¬.Ù… Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø±${shippingText}: <span style='color:#ff2a04;'>${finalTotal}</span>`;
                }
                renderGiftSection(finalTotal);
            }
            updateOrderTotal();
            governorateInput.addEventListener('input', updateOrderTotal);
            discountCodeInput.addEventListener('input', function() {
                const code = this.value.trim().toUpperCase();
                discountCodeMsg.style.display = 'none';
                discountCodeError.style.display = 'none';
                discountValue = 0;
                discountCodeUsed = '';
                if(code.length === 6) {
                    firebase.database().ref('discountCodes/' + code).once('value', snap => {
                        if(!snap.exists()) {
                            discountCodeError.innerText = 'ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… ØºÙŠØ± ØµØ­ÙŠØ­.';
                            discountCodeError.style.display = 'block';
                            updateOrderTotal();
                            return;
                        }
                        const d = snap.val();
                        if(new Date(d.expires) < new Date()) {
                            discountCodeError.innerText = 'Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ….';
                            discountCodeError.style.display = 'block';
                            updateOrderTotal();
                            return;
                        }
                        if((d.usedCount || 0) >= (d.maxUses || 1)) {
                            discountCodeError.innerText = 'ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… Ù…Ù† Ù‚Ø¨Ù„.';
                            discountCodeError.style.display = 'block';
                            updateOrderTotal();
                            return;
                        }
                        discountValue = parseFloat(d.amount);
                        discountCodeUsed = d.code;
                        discountCodeMsg.innerText = `ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… (${d.code}) ÙˆØªÙ… Ø®ØµÙ… ${d.amount} Ø¬Ù†ÙŠÙ‡.`;
                        discountCodeMsg.style.display = 'block';
                        updateOrderTotal();
                    });
                } else {
                    updateOrderTotal();
                }
            });
            // ---
            document.getElementById('orderForm').onsubmit = function(e) {
                e.preventDefault();
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
                const val = whatsappInput.value;
                if(!/^[0-9]{11}$/.test(val)) {
                    whatsappError.innerText = 'Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù…Ù‹Ø§ (Ø£Ø±Ù‚Ø§Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·)';
                    whatsappError.style.display = 'block';
                    whatsappInput.focus();
                    return;
                } else {
                    whatsappError.style.display = 'none';
                }
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡
                const phone2Val = phone2Input.value;
                if(phone2Val && !/^[0-9]{11}$/.test(phone2Val)) {
                    phone2Error.innerText = 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 11 Ø±Ù‚Ù…Ù‹Ø§ (Ø£Ø±Ù‚Ø§Ù… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·)';
                    phone2Error.style.display = 'block';
                    phone2Input.focus();
                    return;
                } else {
                    phone2Error.style.display = 'none';
                }
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©
                const govVal = governorateInput.value.trim();
                if (!govVal || !governorates.includes(govVal)) {
                    governorateError.innerText = 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.';
                    governorateError.style.display = 'block';
                    governorateInput.focus();
                    return;
                } else {
                    governorateError.style.display = 'none';
                }
                const fd = new FormData(this);
                let total = cart.reduce((sum, item) => sum + (parseFloat(item.priceAfter) * (item.qty || 1)), 0);
                let afterDiscount = Math.max(0, total - discountValue);
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø­Ù† Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©
                let shipping = 0;
                const gov85 = ['Ø§Ù„Ø´Ø±Ù‚ÙŠØ©','Ø§Ù„ØºØ±Ø¨ÙŠØ©','Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©','Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©','Ø§Ù„Ø¨Ø­ÙŠØ±Ø©','Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯','Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©','Ø§Ù„Ø³ÙˆÙŠØ³','ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®'];
                const gov99 = ['Ø§Ù„Ø£Ù‚ØµØ±','Ø£Ø³ÙˆØ§Ù†','Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯','Ø³ÙˆÙ‡Ø§Ø¬','Ø§Ù„Ù…Ù†ÙŠØ§','Ø£Ø³ÙŠÙˆØ·','Ø´Ø±Ù… Ø§Ù„Ø´ÙŠØ®','Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡','Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±','Ù‚Ù†Ø§','Ù…Ø±Ø³ÙŠ Ù…Ø·Ø±ÙˆØ­','Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ','Ø§Ù„ÙÙŠÙˆÙ…','Ù…Ø±Ø³ÙŠ Ø¹Ù„Ù…'];
                if (govVal === 'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©') shipping = 70;
                else if (govVal === 'Ø§Ù„Ø¬ÙŠØ²Ø©') shipping = 75;
                else if (gov85.includes(govVal)) shipping = 85;
                else if (gov99.includes(govVal)) shipping = 99;
                else if (governorates.includes(govVal)) shipping = 85;
                let finalTotal = afterDiscount + shipping;
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ù‡Ø¯ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 1000 Ø£Ùˆ Ø£ÙƒØ«Ø±
                if (finalTotal >= 1000) {
                    selectedGift = document.querySelector('input[name="gift"]:checked')?.value || '';
                    document.getElementById('giftError').style.display = 'none';
                } else {
                    selectedGift = '';
                }
                const order = {
                    name: fd.get('name'),
                    whatsapp: fd.get('whatsapp'),
                    phone2: fd.get('phone2'),
                    address: fd.get('address'),
                    governorate: govVal,
                    items: cart.map(item => ({...item})),
                    total: finalTotal,
                    shipping: shipping,
                    discountCode: discountCodeUsed || '',
                    discountValue: discountValue,
                    gift: selectedGift,
                    time: new Date().toLocaleString()
                };
                saveOrderToDB(order);
                // Ø¥Ø°Ø§ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙˆØ¯ Ø®ØµÙ…ØŒ Ø²Ø¯ usedCount Ø¨Ù…Ù‚Ø¯Ø§Ø± 1
                if (discountCodeUsed) {
                    const codeRef = firebase.database().ref('discountCodes/' + discountCodeUsed + '/usedCount');
                    codeRef.transaction(current => (current || 0) + 1);
                }
                showOrderSummary(order);
                cart = [];
                updateCartCount();
            };
        }
        function showOrderSummary(order) {
            const container = document.getElementById('mainContainer');
            let html = `<div class='section-title'>ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­</div>`;
            
            html += `<div style='max-width:500px;margin:0 auto;background:#ecf1eb;padding:18px 20px;border-radius:10px; direction:rtl; font-size:1.4rem'>`;    
            html += `<div style='margin-bottom:10px; text-align:center; color:#a1589e;'><b>Ø³ÙˆÙ ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ ÙÙŠ Ø§Ø³Ø±Ø¹ ÙˆÙ‚Øª !!</b> </div>`;
            html += `<div style='margin-bottom:10px;'><b>Ø§Ù„Ø§Ø³Ù…:</b> ${order.name}</div>`;
            html += `<div style='margin-bottom:10px;'><b>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:</b> ${order.whatsapp}</div>`;
            if(order.phone2) {
                html += `<div style='margin-bottom:10px;'><b>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø¥Ø¶Ø§ÙÙŠ:</b> ${order.phone2}</div>`;
            }
            html += `<div style='margin-bottom:10px;'><b>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</b> ${order.address}</div>`;
            html += `<div style='margin-bottom:10px;'><b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</b> <span style='color:#ff2a04;'>${order.total} Ø¬.Ù…</span></div>`;
            html += `<div style='margin-top:18px;text-align:center;'><button onclick='renderProductsSection("man")' style='background:#a1589e;color:#ffffff;font-weight:bold;padding:10px 24px;border-radius:8px;font-size:1.1rem;cursor:pointer;border:none;'>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª</button></div>`;
            html += `</div>`;
            container.innerHTML = html;
        }
        // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function saveOrderToDB(order) {
            // Ø§Ø³ØªØ®Ø¯Ù… orders ÙƒØ¬Ø°Ø±
            const ordersRef = firebase.database().ref('orders');
            ordersRef.push(order);
        }
    </script>
    <script>
        // Ø£Ø¶Ù Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© Ø¨Ø¹Ø¯ addToCart Ù…Ø¨Ø§Ø´Ø±Ø©
        function showAddToCartMessage(productName) {
            const msg = document.getElementById('addToCartMsg');
            if(msg) {
                msg.innerText = ` ! Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø© "${productName}" ØªÙ… Ø§Ø¶Ø§ÙØ© `;
                msg.classList.add('show');
                clearTimeout(msg._hideTimeout);
                msg._hideTimeout = setTimeout(()=>msg.classList.remove('show'), 1500);
            }
        }
        // Ø£Ø¶Ù Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø£Ø¯Ù…Ù†
        function renderOrdersList() {
            const container = document.getElementById('mainContainer');
            container.style.maxWidth = '90vw';
            container.style.width = '90vw';
            container.style.minWidth = '0';
            container.innerHTML = `<div style='display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;'>
                <div class='section-title' style='margin-bottom:0;'>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                <button onclick='renderAdminPanel()' style='background:#ffb300;color:#ffffff;font-weight:bold;padding:10px 24px;border-radius:8px;font-size:1.1rem;cursor:pointer;border:none;'>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
            </div><div id='ordersList'></div>`;
            const ordersRef = firebase.database().ref('orders');
            // Ø§Ø³ØªØ®Ø¯Ù… on Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† once Ù„Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«
            ordersRef.on('value', snapshot => {
                const val = snapshot.val() || {};
                const orders = Object.entries(val); // [id, order]
                let html = '';
                if (!orders.length) {
                    html = '<div style="text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯.</div>';
                } else {
                    html = `<div style='overflow-x:auto;'><table style='width:100%;border-collapse:collapse;background:#232323;border-radius:10px;box-shadow:0 2px 12px #0003;'>
                        <thead>
                            <tr style='background:#181818;color:#ffb300;'>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø§Ù„Ø§Ø³Ù…</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø§Ù„Ù‡Ø¯ÙŠØ©</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø­Ø°Ù</th>
                            </tr>
                        </thead>
                        <tbody>`;
                    orders.reverse().forEach(([id, order]) => {
                        let productsHtml = '';
                        if(order.items && order.items.length) {
                            productsHtml = order.items.map(item => `
                                <div style='display:flex;align-items:center;gap:6px;margin-bottom:4px;'>
                                    <img src='${(item.images && item.images[0]) ? item.images[0] : ''}' style='width:38px;height:38px;object-fit:cover;border-radius:5px;border:1px solid #ffb300;'>
                                    <span style='font-size:1rem;color:#ffb300;font-weight:bold;'>${item.name}</span>
                                    <span style='font-size:0.95rem;color:#000000;'>Ã— ${item.qty}</span>
                                </div>
                            `).join('');
                        }
                        html += `<tr style='border-bottom:1px solid #333;background-color:#ecf1eb;'>
                            <td style='padding:8px 6px;'>${order.name}</td>
                            <td style='padding:8px 6px;'>${order.whatsapp}${order.phone2 ? `<br><span style='color:#888;font-size:0.95em;'>${order.phone2}</span>` : ''}</td>
                            <td style='padding:8px 6px;'>${order.address}</td>
                            <td style='padding:8px 6px;'>${order.governorate || ''}</td>
                            <td style='padding:8px 6px;'>${productsHtml}</td>
                            <td style='padding:8px 6px;'>${order.discountCode ? `${order.discountCode} ${order.discountValue ? `(${order.discountValue} Ø¬Ù†ÙŠÙ‡)` : ''}` : ''}</td>
                            <td style='padding:8px 6px;color:#ffb300;font-weight:bold;'>${order.total} Ø¬.Ù…</td>
                            <td style='padding:8px 6px;text-align:center;'>${order.gift ? `<img src='${order.gift}' style='width:38px;height:38px;object-fit:cover;border-radius:5px;border:1px solid #b9b4e7;' alt='Ù‡Ø¯ÙŠØ©'>` : '-'}</td>
                            <td style='padding:8px 6px;'>${order.time || ''}</td>
                            <td style='padding:8px 6px;'>
                                <select class='order-status-select' data-order-id='${id}' onchange='updateOrderStatus("${id}", this.value)' style='padding:4px 8px;border-radius:6px;font-size:1rem;background:#181818;color:#ffb300;border:1px solid #444;'>
                                    <option value='Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±' ${!order.status||order.status==='Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'?'selected':''}>Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                                    <option value='ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„' ${order.status==='ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„'?'selected':''}>ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                                    <option value='Ù…Ù„ØºÙŠ' ${order.status==='Ù…Ù„ØºÙŠ'?'selected':''}>Ù…Ù„ØºÙŠ</option>
                                </select>
                            </td>
                            <td style='padding:8px 6px;text-align:center;'>
                                <button onclick='deleteOrder("${id}")' title='Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨' style='background:none;border:none;cursor:pointer;'>
                                    <svg width='22' height='22' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M3 6H5H21' stroke='#ff4444' stroke-width='2'/><path d='M8 6V4C8 2.89543 8.89543 2 10 2H14C15.1046 2 16 2.89543 16 4V6M19 6V20C19 21.1046 18.1046 22 17 22H7C5.89543 22 5 21.1046 5 20V6M10 11V17M14 11V17' stroke='#ff4444' stroke-width='2'/></svg>
                                </button>
                            </td>
                        </tr>`;
                    });
                    html += `</tbody></table></div>`;
                }
                document.getElementById('ordersList').innerHTML = html;
                styleOrderStatusSelects();
            });
        }
        // Ø¯Ø§Ù„Ø© Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨
        function deleteOrder(id) {
            if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ')) {
                firebase.database().ref('orders/' + id).remove();
            }
        }
        // Ø£Ø¶Ù Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
        function updateOrderStatus(id, status) {
            firebase.database().ref('orders/' + id + '/status').set(status);
            setTimeout(styleOrderStatusSelects, 100); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„ÙˆÙ† Ø¨Ø¹Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
        }
        // Ø£Ø¶Ù Ø¯Ø§Ù„Ø© Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
        function styleOrderStatusSelects() {
            document.querySelectorAll('.order-status-select').forEach(sel => {
                sel.classList.remove('delivered', 'cancelled', 'pending');
                if(sel.value === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„') {
                    sel.classList.add('delivered');
                } else if(sel.value === 'Ù…Ù„ØºÙŠ') {
                    sel.classList.add('cancelled');
                } else {
                    sel.classList.add('pending');
                }
            });
        }
    </script>
     <style>
        h1{
            color: #222   ;
        }
     </style>
    <script>
        // --- Ø¹Ø±Ø¶ Ù‚Ø³Ù… Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª ---
        function renderFavoritesSection() {
            const container = document.getElementById('mainContainer');
            let html = `<div class='section-title'>Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª</div>`;
            if(favorites.length === 0) {
                html += `<div style='text-align:center;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©.</div>`;
            } else {
                html += `<div class='products-grid'>`;
                favorites.forEach((favItem, idx) => {
                    const prod = products.find(p => p.name === favItem.name && p.type === favItem.type);
                    if (!prod) return;
                    const fadeDelay = idx * 60;
                    let slider = '';
                    if(prod.images && prod.images.length > 1) {
                        slider = `
                        <div class='img-slider' style='position:relative;'>
                            <img src='${prod.images[0]}' class='slider-img' style='cursor:pointer; colo' onclick='showImageModal("${prod.images[0]}")' data-slider-idx='0' data-prod-idx='${idx}'>
                            <button class='slider-btn left' onclick='event.stopPropagation();window.changeSlide(this,${idx},-1)' style='position:absolute;left:2px;top:50%;transform:translateY(-50%);background:#222a;padding:2px 8px;border:none;color:#fc03efff;font-size:1.2rem;cursor:pointer;border-radius:4px;'>â€¹</button>
                            <button class='slider-btn right' onclick='event.stopPropagation();window.changeSlide(this,${idx},1)' style='position:absolute;right:2px;top:50%;transform:translateY(-50%);background:#222a;padding:2px 8px;border:none;color:#fc03efff;font-size:1.2rem;cursor:pointer;border-radius:4px;'>â€º</button>
                        </div>`;
                    } else {
                        slider = `<img src='${prod.images[0] || ''}' style='cursor:pointer;' onclick='showImageModal("${prod.images[0]}")'>`;
                    }
                    let fav = isFavorite(prod);
                    let heartBtn = `<button onclick='window.toggleFavorite("${prod.name.replace(/"/g, '&quot;')}", "${prod.type}")' style='position:absolute;top:6px;right:0;background:none;border:none;cursor:pointer;z-index:10;'>
                        <svg width='32' height='32' viewBox='0 0 24 24' fill='${fav ? "#ff4444" : "none"}' stroke='#ff4444' stroke-width='2'><path d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/></svg>
                    </button>`;
                    let availableHtml = (prod.available === false) ? `<div style='color:#ff4444;font-weight:bold;margin-top:6px;'>ØºÙŠØ± Ù…ØªÙˆÙØ±</div>` : '';
                    html += `
                    <div class='product-card' style='overflow:visible; --fade-delay:${fadeDelay}ms;'>
                        <div style='position:relative;'>
                            ${slider}
                            ${heartBtn}
                            ${availableHtml}
                        </div>
                        <div class='product-title'>${prod.name}</div>
                        <div class='product-desc'>${prod.desc}</div>
                        <div class='product-type'>${prod.type}</div>
                        <div class='product-prices'>
                            <del>${prod.priceBefore} Ø¬.Ù…</del> <span>${prod.priceAfter} Ø¬.Ù…</span>
                        </div>
                        ${(prod.available === false) ? '' : `<button class='add-to-cart-btn' onclick='addToCart(${JSON.stringify(prod)})' style='background:#25d366;color:#fff;font-weight:bold;padding:8px 0;border-radius:6px;width:100%;margin-top:8px;font-size:1.1rem;cursor:pointer;border:none;'>Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>`}
                    </div>
                    `;
                });
                html += `</div>`;
            }
            container.innerHTML = html;
        }
        // Ø²Ø± Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰
        document.getElementById('favoritesBtn').onclick = function() {
            document.querySelectorAll('.navbar li').forEach(l=>l.classList.remove('active'));
            renderFavoritesSection();
        };
    </script>
    <script>
        // --- ØµÙØ­Ø© Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®ØµÙ… ÙÙŠ Ø§Ù„Ø£Ø¯Ù…Ù† ---
        function renderDiscountCodesPage() {
            const container = document.getElementById('mainContainer');
            container.style.maxWidth = '90vw';
            container.style.width = '90vw';
            container.style.minWidth = '0';
            container.innerHTML = `<div style='display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;'>
                <div class='section-title' style='margin-bottom:0;'>Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®ØµÙ…</div>
                <button onclick='renderAdminPanel()' style='background:#ffb300;color:#222;font-weight:bold;padding:10px 24px;border-radius:8px;font-size:1.1rem;cursor:pointer;border:none;'>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
            </div>
            <button onclick='showAddDiscountCodeForm()' style='background:#25d366;color:#fff;font-weight:bold;padding:10px 24px;border-radius:8px;font-size:1.1rem;cursor:pointer;border:none;margin-bottom:18px;'>Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ¯ Ø®ØµÙ… Ø¬Ø¯ÙŠØ¯</button>
            <div id='discountCodesFormContainer'></div>
            <div id='discountCodesList'></div>`;
            // Ø¬Ù„Ø¨ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            firebase.database().ref('discountCodes').on('value', snapshot => {
                const val = snapshot.val() || {};
                const codes = Object.values(val).sort((a, b) => {
                    if (a.createdAt && b.createdAt) {
                        return new Date(b.createdAt) - new Date(a.createdAt);
                    }
                    return b.code.localeCompare(a.code);
                });
                let html = '';
                if (!codes.length) {
                    html = '<div style="text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙƒÙˆØ§Ø¯ Ø®ØµÙ… Ø¨Ø¹Ø¯.</div>';
                } else {
                    html = `<div style='overflow-x:auto;'><table style='width:100%;border-collapse:collapse;background:#ecf1eb;border-radius:10px;box-shadow:0 2px 12px #0003;'>
                        <thead>
                            <tr style='background:#181818;color:#ffb300;'>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø§Ù„ÙƒÙˆØ¯</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… (Ø¬Ù†ÙŠÙ‡)</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th>
                                <th style='padding:10px 6px;border-bottom:2px solid #444;'>Ø­Ø°Ù</th>
                            </tr>
                        </thead>
                        <tbody>`;
                    codes.forEach(code => {
                        let usageInfo = '';
                        const used = code.usedCount || 0;
                        const maxUses = code.maxUses || 1;
                        const remaining = maxUses - used;
                        // Always show usage info for all codes
                        let remainingColor = remaining === 0 ? '#ff4444' : (remaining < 3 ? '#ffb300' : '#25d366');
                        if (used > 0 || maxUses > 1) {
                            usageInfo = `<span style='color:#25d366;font-size:0.95em;margin-right:8px;'>ØªÙ… Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… (${used})</span> - <span style='color:${remaining === 0 ? '#ff4444' : '#888'};font-size:0.95em;margin-right:4px;'>Ù…ØªØ¨Ù‚ÙŠ (${remaining})</span>`;
                        } else {
                            usageInfo = `<span style='color:${remaining === 0 ? '#ff4444' : '#888'};font-size:0.95em;margin-right:8px;'>Ù…ØªØ¨Ù‚ÙŠ (${remaining})</span>`;
                        }
                        html += `<tr style='border-bottom:1px solid #333;'>
                            <td style='padding:8px 6px;font-weight:bold;'>${code.code} ${usageInfo}</td>
                            <td style='padding:8px 6px;'>${code.amount} Ø¬Ù†ÙŠÙ‡</td>
                            <td style='padding:8px 6px;'>${code.expires ? new Date(code.expires).toLocaleString() : ''}</td>
                            <td style='padding:8px 6px;text-align:center;'>
                                <button onclick='deleteDiscountCode("${code.code}")' title='Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ¯' style='background:none;border:none;cursor:pointer;'>
                                    <svg width='22' height='22' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M3 6H5H21' stroke='#ff4444' stroke-width='2'/><path d='M8 6V4C8 2.89543 8.89543 2 10 2H14C15.1046 2 16 2.89543 16 4V6M19 6V20C19 21.1046 18.1046 22 17 22H7C5.89543 22 5 21.1046 5 20V6M10 11V17M14 11V17' stroke='#ff4444' stroke-width='2'/></svg>
                                </button>
                            </td>
                        </tr>`;
                    });
                    html += `</tbody></table></div>`;
                }
                var discountCodesList = document.getElementById('discountCodesList');
                if (discountCodesList) {
                    discountCodesList.innerHTML = html;
                }
            });
        }
        function showAddDiscountCodeForm() {
            document.getElementById('discountCodesFormContainer').innerHTML = `
                <form id='addDiscountCodeForm' style='background:#232323; color:red;padding:18px 20px;border-radius:10px;margin-bottom:18px;max-width:400px;'>
                    <label>ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… (6 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù…)</label>
                    <input type='text' name='code' maxlength='6' required pattern='[A-Za-z0-9]{6}' style='width:100%;padding:8px;border-radius:6px;margin-bottom:10px;font-size:1.1rem;'>
                    <label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… (Ø¬Ù†ÙŠÙ‡)</label>
                    <input type='number' name='amount' min='1' required style='width:100%;padding:8px;border-radius:6px;margin-bottom:10px;font-size:1.1rem;'>
                    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</label>
                    <input type='datetime-local' name='expires' required style='width:100%;padding:8px;border-radius:6px;margin-bottom:10px;font-size:1.1rem;'>
                    <label>Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</label>
                    <input type='number' name='maxUses' min='1' value='1' required style='width:100%;padding:8px;border-radius:6px;margin-bottom:10px;font-size:1.1rem;'>
                    <button type='submit' style='background:#ffb300;color:#222;font-weight:bold;padding:10px 24px;border-radius:8px;font-size:1.1rem;cursor:pointer;border:none;'>Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯</button>
                    <button type='button' onclick='hideAddDiscountCodeForm()' style='margin-right:10px;background:#333;color:#fff;'>Ø¥Ù„ØºØ§Ø¡</button>
                    <div id='discountCodeError' style='color:#ff4444;font-size:1rem;margin-top:8px;'></div>
                </form>`;
            document.getElementById('addDiscountCodeForm').onsubmit = function(e) {
                e.preventDefault();
                const fd = new FormData(this);
                const code = fd.get('code').toUpperCase();
                const amount = parseInt(fd.get('amount'));
                const expires = fd.get('expires');
                const maxUses = parseInt(fd.get('maxUses')) || 1;
                if(!/^[A-Za-z0-9]{6}$/.test(code)) {
                    document.getElementById('discountCodeError').innerText = 'ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù….';
                    return;
                }
                if(amount <= 0) {
                    document.getElementById('discountCodeError').innerText = 'Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±.';
                    return;
                }
                if(maxUses < 1) {
                    document.getElementById('discountCodeError').innerText = 'Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 1 Ø£Ùˆ Ø£ÙƒØ«Ø±.';
                    return;
                }
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„ÙƒÙˆØ¯
                firebase.database().ref('discountCodes/' + code).once('value', snap => {
                    if(snap.exists()) {
                        document.getElementById('discountCodeError').innerText = 'Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„.';
                        return;
                    }
                    // Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯
                    firebase.database().ref('discountCodes/' + code).set({
                        code,
                        amount,
                        expires,
                        maxUses,
                        usedCount: 0,
                        createdBy: 'admin',
                        createdAt: new Date().toISOString()
                    }, () => {
                        hideAddDiscountCodeForm();
                    });
                });
            };
        }
        function hideAddDiscountCodeForm() {
            document.getElementById('discountCodesFormContainer').innerHTML = '';
        }
        function deleteDiscountCode(code) {
            if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…ØŸ')) {
                firebase.database().ref('discountCodes/' + code).remove();
            }
        }
        window.renderDiscountCodesPage = renderDiscountCodesPage;
        window.deleteDiscountCode = deleteDiscountCode;
        window.showAddDiscountCodeForm = showAddDiscountCodeForm;
        window.hideAddDiscountCodeForm = hideAddDiscountCodeForm;
    </script>
    <!-- Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ù…Ø±ØªÙŠÙ† Ø¹Ù„Ù‰ Ø´Ø¹Ø§Ø± icon4.png ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø±ØŒ Ø§ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ø¯Ù…Ù† -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var logoImg = document.querySelector('.logo img');
            if (logoImg) {
                logoImg.ondblclick = function(e) {
                    if (typeof showAdminLogin === 'function') showAdminLogin();
                };
            }
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.navbar li[data-section]').forEach(function(li) {
                if (!li.querySelector('.shine')) {
                    var shine = document.createElement('span');
                    shine.className = 'shine';
                    li.appendChild(shine);
                }
            });
        });
    </script>
</body>
</html>
